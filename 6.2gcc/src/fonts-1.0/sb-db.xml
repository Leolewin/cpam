<?xml version="1.0"?>
<programs>
  <program name="fonts" version="1.0" revision="1">
    <install-name>${SB_PROG_NAME}10</install-name>

    <dependencies>
      <depend program="fcpackage" var="FCPACKAGE"
        install-name="fcpackage22">v==2.2</depend>
      <depend program="perl" var="PERL">v==5.8.2</depend>
    </dependencies>

    <script-header>
<![CDATA[
_datadir="${SB_INSTALL_PREFIX}/share"
]]>
    </script-header>

    <module name="console">
      <build-name>${SB_MODULE_NAME}-1.0</build-name>

      <sources>
        <source checksum="72e1ca69869367624263d5bfe3608848"
          checksum-type="md5" size="84668"
          path="src/console-1.0.tar.bz2"/>
      </sources>

      <build>
<![CDATA[
:
]]>
      </build>

      <install>
<![CDATA[
${SB_PATH_INSTALL} -m 755 -o root -g 0 -d ${_datadir}/console
${SB_PATH_INSTALL} -m 644 -o root -g 0 *.pcf ${_datadir}/console

${SB_VAR_FCPACKAGE}/bin/fc-cache -f ${_datadir}
${SB_VAR_FCPACKAGE}/bin/fc-cache ${_datadir}/console
]]>
      </install>

      <uninstall>
<![CDATA[
rm -rf ${_datadir}/console
]]>
      </uninstall>
    </module>

    <module name="lucida">
      <build-name>${SB_MODULE_NAME}-1.0</build-name>

      <sources>
        <source checksum="c0d24be6d176db62f1a32ee2d776c039"
          checksum-type="md5" size="107526"
          path="src/lucida-1.0.tar.bz2"/>
      </sources>

      <build>
<![CDATA[
:
]]>
      </build>

      <install>
<![CDATA[
${SB_PATH_INSTALL} -m 755 -o root -g 0 -d ${_datadir}/lucida
${SB_PATH_INSTALL} -m 644 -o root -g 0 *.pcf ${_datadir}/lucida

${SB_VAR_FCPACKAGE}/bin/fc-cache -f ${_datadir}
${SB_VAR_FCPACKAGE}/bin/fc-cache ${_datadir}/lucida
]]>
      </install>

      <uninstall>
<![CDATA[
rm -rf ${_datadir}/lucida
]]>
      </uninstall>
    </module>

    <module name="bitstream-vera">
      <build-name>ttf-${SB_MODULE_NAME}-1.10</build-name>

      <sources>
        <source checksum="bb22bd5b4675f5dbe17c6963d8c00ed6"
          checksum-type="md5" size="264276"
          path="src/ttf-bitstream-vera-1.10.tar.bz2"/>
      </sources>

      <build>
<![CDATA[
:
]]>
      </build>

      <install>
<![CDATA[
${SB_PATH_INSTALL} -m 755 -o root -g 0 -d ${_datadir}/bitstream-vera
${SB_PATH_INSTALL} -m 644 -o root -g 0 *.ttf ${_datadir}/bitstream-vera

${SB_VAR_FCPACKAGE}/bin/fc-cache -f ${_datadir}
${SB_VAR_FCPACKAGE}/bin/fc-cache ${_datadir}/bitstream-vera
]]>
      </install>

      <uninstall>
<![CDATA[
rm -rf ${_datadir}/bitstream-vera
]]>
      </uninstall>
    </module>

    <module name="ucs">
      <build-name>${SB_MODULE_NAME}-fonts</build-name>

      <sources>
        <source checksum="2b98dcab0b20cc6856d4973199e92bdc"
          checksum-type="md5" size="834209"
          path="src/ucs-fonts.tar.gz"
          destdir="ucs-fonts"/>
      </sources>

      <build>
<![CDATA[
# convert .bdf to .pcf
for _font in [0-9]*.bdf; do
  # change the font name to "MiscFixed" from "Fixed" to distinguish
  # with "Fixed" console fonts
  ${SB_VAR_PERL}/bin/perl -pi -e "\
s!\"Fixed\"!\"MiscFixed\"!" ${_font}

  echo converting ${_font} to ${_font%%.bdf}.pcf
  bdftopcf -o ${_font%%.bdf}.pcf ${_font}
done
]]>
      </build>

      <install>
<![CDATA[
${SB_PATH_INSTALL} -m 755 -o root -g 0 -d ${_datadir}/ucs
${SB_PATH_INSTALL} -m 644 -o root -g 0 *.pcf ${_datadir}/ucs

${SB_VAR_FCPACKAGE}/bin/fc-cache -f ${_datadir}
${SB_VAR_FCPACKAGE}/bin/fc-cache ${_datadir}/ucs
]]>
      </install>

      <uninstall>
<![CDATA[
rm -rf ${_datadir}/ucs
]]>
      </uninstall>
    </module>

    <changelog>
      <change date="2004 August 12" revision="2"
      author="Albert Chin-A-Young" email="china@thewrittenword.com">
        <item><para>Add per-module uninstall section</para></item>
      </change>

      <change date="2004 March 2" revision="1"
      author="Albert Chin-A-Young" email="china@thewrittenword.com">
        <item><para>Add console fonts</para></item>
        <item><para>Add Lucida fonts</para></item>
        <item><para>Add UCS bitmap fonts</para></item>
        <item><para>Run fontconfig fc-cache on each font directory to
cache contents</para></item>
      </change>
    </changelog>
  </program>
</programs>

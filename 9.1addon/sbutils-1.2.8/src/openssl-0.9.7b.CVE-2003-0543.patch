Index: crypto/asn1/asn1_lib.c
===================================================================
--- crypto/asn1/asn1_lib.c.orig	2005-11-03 09:21:51.681766000 -0600
+++ crypto/asn1/asn1_lib.c	2005-11-03 09:25:04.882818000 -0600
@@ -104,6 +104,7 @@
 			l<<=7L;
 			l|= *(p++)&0x7f;
 			if (--max == 0) goto err;
+			if (l > (INT_MAX >> 7L)) goto err;
 			}
 		l<<=7L;
 		l|= *(p++)&0x7f;

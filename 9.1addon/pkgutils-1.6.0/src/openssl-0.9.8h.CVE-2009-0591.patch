Index: crypto/cms/cms_smime.c
===================================================================
--- crypto/cms/cms_smime.c.orig	2008-04-18 11:19:55.000000000 +0000
+++ crypto/cms/cms_smime.c	2010-03-04 21:28:52.839675238 +0000
@@ -420,7 +420,7 @@
 		for (i = 0; i < sk_CMS_SignerInfo_num(sinfos); i++)
 			{
 			si = sk_CMS_SignerInfo_value(sinfos, i);
-			if (!CMS_SignerInfo_verify_content(si, cmsbio))
+			if (CMS_SignerInfo_verify_content(si, cmsbio) <= 0)
 				{
 				CMSerr(CMS_F_CMS_VERIFY,
 					CMS_R_CONTENT_VERIFY_ERROR);

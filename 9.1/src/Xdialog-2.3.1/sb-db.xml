<?xml version="1.0"?>
<programs>
<!DOCTYPE programs SYSTEM "sb-db.dtd">
  <program name="Xdialog" version="2.3.1" revision="4">
    <build-name>${SB_PROG_NAME}-${SB_PROG_VER}</build-name>

    <install-name>xdialog23</install-name>

    <sources>
      <source checksum="0671f8353717513bf1f0ebc80e9710f6"
        checksum-type="md5" size="457938"
        path="src/Xdialog-2.3.1.tar.bz2"/>
      <patch checksum="5b39f5c09d3832b96950cfba01105721"
        checksum-type="md5" size="380"
        path="src/Xdialog-2.3.1.tww.patch"/>
      <patch checksum="38d431c9907be6e7ec7684eaffd54ba6"
        checksum-type="md5" size="489648"
        path="src/Xdialog-2.3.1.auto.patch"/>
    </sources>

    <dependencies>
      <depend program="gettext" var="GETTEXT"
        install-name="gettext018"
        add-path="prepend">v&gt;=0.18.1.1</depend>
      <depend program="gtk+" var="GTK"
        install-name="gtk+12">v&gt;=1.2.10</depend>
      <depend program="libiconv" var="LIBICONV"
        install-name="libiconv113"
        add-path="prepend">v&gt;=1.13.1</depend>
    </dependencies>

    <script-header>
<![CDATA[
_datadir="${SB_INSTALL_PREFIX}/share"
_docdir="${SB_INSTALL_PREFIX}/doc"
]]>
    </script-header>

    <configure>
<![CDATA[
case "${SB_SYSTYPE}" in
*-aix*)
  CC=xlc CFLAGS="-O2 -qro -qroconst -qmaxmem=-1 -qarch=ppc"
  LDFLAGS="-Wl,-brtl -Wl,-blibpath:/usr/lib" ;;
*-hpux11.[01]*)
  CC=cc CFLAGS="-z +O2 +Ofltacc +Olit=all +DAportable \
+Oentrysched +Odataprefetch +Onolimit" ;;
*-hpux11*)
  CC=cc CFLAGS="-z +O2 +Ofltacc +Olit=all +Oentrysched \
+Odataprefetch +Onolimit" ;;
*-irix*)
  CC=cc CFLAGS="-Wl,-woff,84 -Wl,-woff,85 -woff 1009,1429 \
-use_readonly_const -G0 -rdata_shared -DEBUG:optimize_space=ON \
-O2 -OPT:Olimit=0" ;;
i?86*-linux*)
  CFLAGS="-O2 -mtune=pentiumpro -march=pentiumpro" ;;
*-osf*)
  CC=cc CFLAGS="-O2 -arch ev5 -msym -readonly_strings" ;;
i?86*-solaris*)
  CC=cc CFLAGS="-mr -Qn -xstrconst -xO2 -xtarget=pentium4" ;;
*-solaris2.8)
  CC=cc CFLAGS="-mr -Qn -xstrconst -xO2 -xtarget=ultra2 \
-xarch=v8plusa" ;;
*-solaris*)
  CC=cc CFLAGS="-mr -Qn -xstrconst -xO2 -xtarget=ultra2 \
-m32 -xarch=sparcvis" ;;
esac

CC="${CC:-gcc}" CFLAGS="${CFLAGS:--O2}" \
LDFLAGS="${LDFLAGS+${LDFLAGS}}" ./configure \
${SB_VAR_GTK+--with-gtk-prefix=${SB_VAR_GTK}} \
--datadir=${_datadir} --docdir=${_docdir} \
--mandir=${SB_INSTALL_PREFIX}/man \
${SB_VAR_GETTEXT+--with-libintl-prefix=${SB_VAR_GETTEXT}} \
${SB_VAR_LIBICONV+--with-libiconv-prefix=${SB_VAR_LIBICONV}} \
--prefix=${SB_INSTALL_PREFIX}
]]>
    </configure>

    <install>
<![CDATA[
gmake install

${SB_PATH_INSTALL} -m 755 -o root -g 0 -d ${_docdir}

mv ${_datadir}/doc/${SB_PROG_NAME}-${SB_PROG_VER}/* ${_docdir}
rmdir ${_datadir}/doc/${SB_PROG_NAME}-${SB_PROG_VER}
rmdir ${_datadir}/doc
]]>
    </install>

    <notes>
      <change from="2.3.0" to="2.3.1">
        <item><para>Fixed the bug, introduced in v2.3.0, where the
"Hide typing" check button always appeared in the input boxes,
regardless of the existence of a password field.</para></item>
      </change>

      <change from="2.2.1" to="2.3.0">
        <item><para>Added a new --password=1|2 syntax to allow a
password field in one of the first fields of --2inputsbox and
--3inputsbox</para></item>
        <item><para>Added optional &lt;red&gt; &lt;green&gt;
&lt;blue&gt; parameters for the --colorsel widget</para></item>
        <item><para>Corrected a bug in the --treeview widget which was
failing to properly build a tree when decreasing the level of an item
by more than 1, compared to the level of the previous
item.</para></item>
        <item><para>Corrected a bug in the --colorsel widget which
triggered a GTK warning when the --icon option was used</para></item>
        <item><para>Adapted a patch for the GTK2 version of Xdialog
(this version is still seriously broken: DO NOT use it in production
projects), implementing the use of the GTK2 stock icons for the
Xdialog buttons</para></item>
      </change>

      <change from="2.2.0" to="2.2.1">
        <item><para>Corrected the bug in the --dselect widget which
was returning a filename by default, instead of the directory name.
Also removed the file specific fields and buttons from the directory
selector.</para></item>
        <item><para>Corrected a typo in the man page</para></item>
      </change>

      <change from="2.1.2" to="2.2.0">
        <item><para>Added preliminary GTK2 support. Run 'configure'
with the --with-gtk2 option to enable the compilation against GTK2.
!!!! BEWARE !!!!  This should be considered alpha-code, and the GTK2
version of Xdialog does not yet implement everything the GTK1 version
got. It also got many problems when running on non-UTF8 systems... For
-SERIOUS- use, use the GTK+ v1.2.10 version of Xdialog!</para></item>
        <item><para>Added the --timeout option for compatibility with
cdialog</para></item>
        <item><para>Partly successful attempt at fixing a problem
with some patched GTK versions (Mandrake's, for instance) which are
reseting the theme each time all windows are closed (thus breaking
--rc-file). Still an issue with the fixed fonts of the
XDIALOG_HIGH_DIALOG_COMPAT mode, because of another weird patch
(rclocal patch): get unpatched version of GTK+ v1.2.10. Such a version
is available on Xdialog's website.</para></item>
        <item><para>The default fixed font is now:
"-*-*-medium-r-normal-*-*-*-*-*-m-70-*-*" (removed the iso8859-1
specification)</para></item>
        <item><para>Implemented a custom log message handler to
prevent GTK/GDK/GLIB from using stdout as the message
output</para></item>
      </change>
    </notes>

    <changelog>
      <change date="2012 January 18" revision="4"
      author="Peter O'Gorman" email="pogma@thewrittenword.com">
        <item><para>Update gcc dependency from 4.2.4 to
4.4.6</para></item>
        <item><para>Update gettext dependency from 0.17 to
0.18.1.1</para></item>
        <item><para>Update libiconv dependency from 1.12 to
1.13.1</para></item>
      </change>

      <change date="2010 October 28" revision="3"
      author="Albert Chin-A-Young" email="china@thewrittenword.com">
        <item><para>Add support for RHEL 6</para></item>
      </change>

      <change date="2009 November 8" revision="2"
      author="Gary V. Vaughan" email="gary@thewrittenword.com">
        <item><para>Update gcc dependency from 3.4.3 to
4.2.4</para></item>
        <item><para>Update gettext dependency from 0.14.1 to
0.17</para></item>
        <item><para>Update libiconv dependency from 1.9.2 to
1.12</para></item>
      </change>
    </changelog>
  </program>
</programs>

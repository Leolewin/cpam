<?xml version="1.0"?>
<programs>
<!DOCTYPE programs SYSTEM "sb-db.dtd">
  <program name="pinfo" version="0.6.8" revision="10">
    <build-name>${SB_PROG_NAME}-${SB_PROG_VER}</build-name>

    <install-name>${SB_PROG_NAME}06</install-name>

    <sources>
      <source checksum="55feb4ebaa709b52bd00a15ed0fb52fb"
        checksum-type="md5" size="319857"
        path="src/pinfo-0.6.8.tar.gz"/>
      <patch checksum="d4d7ed8d855f56ac3334765f41c35fd2"
        checksum-type="md5" size="163239"
        path="src/pinfo-0.6.8.tww.patch"/>
      <patch checksum="e0483c5cdb5cbd5e0dc7f93ede01ef74"
        checksum-type="md5" size="976219"
        path="src/pinfo-0.6.8.auto.patch"/>
    </sources>

    <dependencies>
      <depend program="bison" install-name="bison24"
        add-path="prepend" type="build">v&gt;=2.4.3</depend>
      <depend program="gettext" var="GETTEXT"
        install-name="gettext018"
        add-path="prepend">v&gt;=0.18.1.1</depend>
      <depend program="libiconv" var="LIBICONV"
        install-name="libiconv113"
        add-path="prepend">v&gt;=1.13</depend>
      <depend program="ncurses" var="NCURSES">v==5.7</depend>
    </dependencies>

    <script-header>
<![CDATA[
_datadir="${SB_INSTALL_PREFIX}/share"
_docdir="${SB_INSTALL_PREFIX}/doc"
_sysconfdir="${SB_INSTALL_PREFIX}/etc"
]]>
    </script-header>

    <configure>
<![CDATA[
case "${SB_SYSTYPE}" in
*-aix*)
  CC=xlc CFLAGS="-O2 -qro -qroconst -qmaxmem=-1 -qarch=ppc"
  LDFLAGS="-Wl,-brtl -Wl,-blibpath:/usr/lib"
  CC_LD_RT="-Wl,-blibpath:" ;;
ia64*-hpux*)
  CC=cc CFLAGS="-z +O2 +Onofltacc +Olit=all +Oentrysched \
+Odataprefetch +Onolimit"
  CC_LD_RT="-Wl,+b," ;;
*-hpux11.[01]*)
  CC=cc CFLAGS="-Ae -z +O2 +Onofltacc +ESlit +DAportable \
+Oentrysched +Odataprefetch +Onolimit"
  CC_LD_RT="-Wl,+s,+b," ;;
*-hpux*)
  CC=cc CFLAGS="-z +O2 +Onofltacc +Olit=all +Oentrysched \
+Odataprefetch +Onolimit"
  CC_LD_RT="-Wl,+s,+b," ;;
*-irix*)
  CC=cc CFLAGS="-Wl,-woff,84 -Wl,-woff,85 -woff 1009,1429 \
-use_readonly_const -G0 -rdata_shared -DEBUG:optimize_space=ON \
-O2 -OPT:Olimit=0"
  CC_LD_RT="-Wl,-rpath," ;;
i?86*-linux*)
  CFLAGS="-O2 -mtune=pentiumpro -march=pentiumpro"
  CC_LD_RT="-Wl,-rpath," ;;
*-linux*)
  CC_LD_RT="-Wl,-rpath," ;;
*-osf*)
  CC=cc CFLAGS="-O2 -arch ev5 -msym -readonly_strings"
  CC_LD_RT="-Wl,-rpath," ;;
i?86*-solaris*)
  CC=cc CFLAGS="-mr -Qn -features=no%extinl -xstrconst \
-xO2 -xtarget=pentium4"
  CC_LD_RT="-R" ;;
*-solaris2.8)
  CC=cc CFLAGS="-mr -Qn -xstrconst -features=no%extinl -xO2 \
-xtarget=ultra2 -xarch=v8plusa"
  CC_LD_RT="-R" ;;
*-solaris*)
  CC=cc CFLAGS="-mr -Qn -xstrconst -features=no%extinl -xO2 \
-xtarget=ultra2 -m32 -xarch=sparcvis"
  CC_LD_RT="-R" ;;
esac

${SHELL} ./configure CC="${CC:-gcc}" CFLAGS="${CFLAGS:--O2}" \
CPPFLAGS="-I${SB_VAR_NCURSES_INC}/ncurses" \
LDFLAGS="${CC_LD_RT}${SB_VAR_NCURSES_LIB} \
${LDFLAGS+${LDFLAGS}}" --with-ncurses=${SB_VAR_NCURSES} \
--datadir=${_datadir} --sysconfdir=${_sysconfdir} \
--with-libintl-prefix=${SB_VAR_GETTEXT} \
${SB_VAR_LIBICONV+--with-libiconv-prefix=${SB_VAR_LIBICONV}} \
--with-infopath="/opt/info:${SB_INSTALL_BASE}/info:\
/usr/local/info:/usr/info" --disable-dependency-tracking \
--prefix=${SB_INSTALL_PREFIX}

# rebuild info files
rm -f doc/pinfo.info
]]>
    </configure>

    <build>
<![CDATA[
gmake MAKEINFOFLAGS="--no-split"
]]>
    </build>

    <install>
<![CDATA[
gmake install

${SB_PATH_INSTALL} -m 755 -o root -g 0 -d ${_docdir}
${SB_PATH_INSTALL} -m 644 -o root -g 0 doc/pinfo.texi ${_docdir}
]]>
    </install>

    <notes>
      <change from="0.6.7" to="0.6.8">
        <item><para>Patches for node detection algorithms in man and
info</para></item>
        <item><para>Added default item on search prompt</para></item>
        <item><para>Bugfix in info link freeing procedure, which
failed on exim pages</para></item>
        <item><para>Bugfix for dir page lookup when several matches
are found--there was a double close() problem</para></item>
      </change>

      <change from="0.6.6" to="0.6.7">
        <item><para>Added scrolling in left/right direction (!!!new
config file keys)</para></item>
        <item><para>Fixed handling of info entries like
`emacs21/emacs'--modified function matchfile()</para></item>
        <item><para>Added autmatical detection of rawfilename for
filenames beginning with `../', `./', `/' in main()</para></item>
        <item><para>Added support for '(gcc)Introduction' like
specification of nodes</para></item>
      </change>

      <change from="0.6.5" to="0.6.6">
        <item><para>Bugfixes for userdefined rcfile and configuration
inconsistences added sorting of matches for the info file to display
0.6.5   </para></item>
        <item><para>Fixed bug in sorting of tag table links (major
effect to the engine)</para></item>
        <item><para>Changed the file search engine to scan the
directory for a matching pattern (instead of trying various
propositions).</para></item>
        <item><para>Fixed minor sigsegv bug in page loader (link
initializer)</para></item>
        <item><para>Added switching between sections in manualviewer
mode</para></item>
        <item><para>Highlighting code does not highlight leading
spaces in splitted notes anymore</para></item>
        <item><para>Added information when the search is not
successful</para></item>
        <item><para>Added support for command line selected rc
files</para></item>
      </change>

      <change from="0.6.4" to="0.6.5">
        <item><para>New apropos handler. It works now interactively.
New option -p here.</para></item>
        <item><para>Doesn't highlight anymore links to itself in man
viewer</para></item>
        <item><para>Fixed bug with link following</para></item>
        <item><para>Fixed readline emulation: it now deletes old line
content, and handles end key</para></item>
        <item><para>Fixed SIGWINCH handler/curses blocking getch
emulation</para></item>
        <item><para>Fixed searchpath routines. First of all, there is
introduced a 'context' for currently viewed file. Pinfo will search
files for one set of infopages only in one directory--in the context
directory.</para></item>
        <item><para>The context can be changed only when changing the
set of infopages</para></item>
      </change>

      <note type="usage">
        <para>The global configuration file resides in
<command>${SB_INSTALL_PREFIX}/etc/pinforc</command>.</para>
        <para>The default info search path is:</para>
        <unorderedlist>
          <item><para><command>/opt/info</command></para></item>
          <item><para><command>${SB_INSTALL_BASE}/info</command></para></item>
          <item><para><command>/usr/local/info</command></para></item>
          <item><para><command>/usr/info</command></para></item>
        </unorderedlist>

        <para>The environment variable <command>INFOPATH</command>
prepends additional info search paths to the above list.
<command>INFOPATH</command> is a colon-separated list of paths.</para>
      </note>
    </notes>

    <changelog>
      <change date="2012 January 31" revision="10"
      author="Albert Chin-A-Young" email="china@thewrittenword.com">
        <item><para>Update bison dependency from 2.3 to
2.4.3</para></item>
        <item><para>Update gettext dependency from 0.17 to
0.18.1.1</para></item>
        <item><para>Update libiconv dependency from 1.12 to
1.13</para></item>
        <item><para>Update ncurses dependency from 5.6 to
5.7</para></item>
      </change>

      <change date="2010 November 11" revision="9"
      author="Gary V. Vaughan" email="gary@thewrittenword.com">
        <item><para>Add support for RHEL 6</para></item>
      </change>

      <change date="2009 December 3" revision="8"
      author="Peter O'Gorman" email="pogma@thewrittenword.com">
        <item><para>Update libiconv dependency from 1.9.2 to
1.12</para></item>
        <item><para>Update gettext dependency from 0.14.1 to
0.17</para></item>
      </change>

      <change date="2007 October 15" revision="7"
      author="Albert Chin-A-Young" email="china@thewrittenword.com">
        <item><para>Update ncurses dependency from 5.4 to
5.6</para></item>
      </change>

      <change date="2007 May 4" revision="6"
      author="Albert Chin-A-Young" email="china@thewrittenword.com">
        <item><para>Add support for RHEL 5</para></item>
      </change>

      <change date="2006 September 25" revision="5"
      author="Albert Chin-A-Young" email="china@thewrittenword.com">
        <item><para>Update bison dependency from 2.1 to
2.3</para></item>
      </change>

      <change date="2006 July 19" revision="4"
      author="Albert Chin-A-Young" email="china@thewrittenword.com">
        <item><para>Add support for Solaris 10/x86</para></item>
      </change>

      <change date="2005 December 31" revision="3"
      author="Albert Chin-A-Young" email="china@thewrittenword.com">
        <item><para>Add support for HP-UX 11.23/IA-64</para></item>
      </change>

      <change date="2005 November 30" revision="2"
      author="Albert Chin-A-Young" email="china@thewrittenword.com">
        <item><para>Add support for HP-UX 11.23/PA-RISC</para></item>
      </change>
    </changelog>
  </program>
</programs>

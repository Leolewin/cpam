<?xml version="1.0"?>
<programs>
<!DOCTYPE programs SYSTEM "sb-db.dtd">
  <program name="gnuplot" version="4.4.4" revision="1">
    <install-name>${SB_PROG_NAME}44</install-name>

    <module name="default">
      <build-name>${SB_PROG_NAME}-${SB_PROG_VER}</build-name>

      <sources>
        <source checksum="97a43328e81e57ebed7f135ca0c07e82"
          checksum-type="md5" size="3328278"
          path="src/gnuplot-4.4.4.tar.gz"/>
        <patch checksum="4e01d9aa9aac5d5b5ad0b08059f0709c"
          checksum-type="md5" size="8480"
          path="src/gnuplot-4.4.4.tww.patch"/>
        <patch checksum="344b446e3acd64b97a758a80e3eef552"
          checksum-type="md5" size="129975"
          path="src/gnuplot-4.4.4.auto.patch"/>
      </sources>

      <dependencies>
        <depend program="lua" var="LUA" install-name="lua51"
          add-path="prepend">v&gt;=5.1.4</depend>
        <depend program="pkgconfig" install-name="pkgconfig02"
          add-path="prepend" type="build">v&gt;=0.25</depend>
        <depend program="fonts" var="FONTS" install-name="fonts11"
          module="urw">v&gt;=1.1</depend>
        <depend program="ghostscript" var="GHOSTSCRIPT"
          install-name="ghostscript90" add-path="prepend"
          type="build">v&gt;=9.01</depend>
        <depend program="tetex" install-name="tetex30"
          add-path="prepend" type="build">v&gt;=3.0</depend>
        <depend program="gd" var="LIBGD"
          install-name="libgd20">v&gt;=2.0.35</depend>
        <depend program="libedit" var="LIBEDIT"
          install-name="libedit21">v&gt;=2.11</depend>
        <depend program="libpng" var="LIBPNG"
          install-name="libpng14">v&gt;=1.4.4</depend>
        <depend program="zlib" var="ZLIB"
          install-name="libz12">v&gt;=1.2.5</depend>
        <depend program="ncurses" var="NCURSES">v==5.7</depend>
      </dependencies>

      <validate>
        <depend program="gnuplot"
          module="python-2.6.7">v==4.4.4</depend>
        <depend program="gnuplot"
          module="python-2.7.2">v==4.4.4</depend>
      </validate>

      <script-header>
<![CDATA[
_datadir="${SB_INSTALL_PREFIX}/share"
_docdir="${SB_INSTALL_PREFIX}/doc"
_urw_fonts="${SB_VAR_FONTS}/share/urw"
]]>
      </script-header>

      <configure>
<![CDATA[
case "${SB_SYSTYPE}" in
*-aix*)
  CC=xlc CFLAGS="-O2 -qro -qroconst -qmaxmem=-1 -qarch=ppc"
  LDFLAGS="-Wl,-brtl,-bnortllib,-blibpath:/usr/lib"
  CC_LD_RT="-Wl,-blibpath:" ;;
ia64*-hpux*)
  CC=cc CFLAGS="-z +O2 +Onofltacc +Olit=all +Oentrysched \
+Odataprefetch +Onolimit"
  CC_LD_RT="-Wl,+b,"
  X_INCLUDES="/usr/include/X11R6 -I/usr/contrib/X11R6/include"
  X_LIBRARIES="/usr/lib/X11R6 -L/usr/contrib/X11R6/lib" ;;
*-hpux11.[01]*)
  CC=cc CFLAGS="-Ae -z +O2 +Onofltacc +ESlit +DAportable \
+Oentrysched +Odataprefetch +Onolimit"
  CPPFLAGS="-Ae" CC_LD_RT="-Wl,+s,+b,"
  X_INCLUDES="/usr/include/X11R6 -I/usr/contrib/X11R6/include"
  X_LIBRARIES="/usr/lib/X11R6 -L/usr/contrib/X11R6/lib" ;;
*-hpux*)
  CC=cc CFLAGS="-z +O2 +Onofltacc +Olit=all +Oentrysched \
+Odataprefetch +Onolimit"
  CC_LD_RT="-Wl,+s,+b,"
  X_INCLUDES="/usr/include/X11R6 -I/usr/contrib/X11R6/include"
  X_LIBRARIES="/usr/lib/X11R6 -L/usr/contrib/X11R6/lib" ;;
*-irix*)
  CC=c99 CFLAGS="-Wl,-woff,84 -Wl,-woff,85 -woff 1009,1429 \
-use_readonly_const -G0 -rdata_shared -DEBUG:optimize_space=ON \
-O2 -OPT:Olimit=0:IEEE_comparisons=ON:IEEE_NaN_inf=ON"
  CC_LD_RT="-Wl,-rpath," ;;
i?86*-linux*)
  CFLAGS="-O2 -mtune=pentiumpro -march=pentiumpro"
  CC_LD_RT="-Wl,-rpath," ;;
*-linux*)
  CC_LD_RT="-Wl,-rpath," ;;
*-osf*)
  CC=cc CFLAGS="-O2 -ieee -arch ev5 -msym -readonly_strings"
  CC_LD_RT="-Wl,-rpath," ;;
i?86*-solaris*)
  CC=cc CFLAGS="-mr -Qn -xstrconst -xO2 -xtarget=pentium4"
  CC_LD_RT="-R" ;;
*-solaris2.8)
  CC=cc CFLAGS="-mr -Qn -xstrconst -xO2 -xtarget=ultra2 \
-xarch=v8plusa"
  CC_LD_RT="-R" ;;
*-solaris*)
  CC=cc CFLAGS="-mr -Qn -xstrconst -xO2 -xtarget=ultra2 \
-m32 -xarch=sparcvis"
  CC_LD_RT="-R" ;;
esac

# set correct path to URW fonts
${SB_PATH_SED} -i -e "\
s!@URW_FONT_DIR@!${_urw_fonts}!;" src/variable.c

${SHELL} ./configure CC="${CC:-gcc}" CFLAGS="${CFLAGS:--O2}" \
CPPFLAGS="${SB_VAR_ZLIB+-I${SB_VAR_ZLIB_INC}} \
${SB_VAR_LIBEDIT+-I${SB_VAR_LIBEDIT_INC}} \
${SB_VAR_NCURSES+-I${SB_VAR_NCURSES_INC}} \
${SB_VAR_LUA+-I${SB_VAR_LUA_INC}} \
${CPPFLAGS+${CPPFLAGS}}" \
LDFLAGS="${SB_VAR_ZLIB+-L${SB_VAR_ZLIB_LIB}} \
${SB_VAR_LIBEDIT+-L${SB_VAR_LIBEDIT_LIB}} \
${SB_VAR_NCURSES+-L${SB_VAR_NCURSES_LIB}} \
${SB_VAR_LIBEDIT+${CC_LD_RT}${SB_VAR_LIBEDIT_LIB}} \
${SB_VAR_NCURSES+${CC_LD_RT}${SB_VAR_NCURSES_LIB}} \
${SB_VAR_LIBPNG+${CC_LD_RT}${SB_VAR_LIBPNG_LIB}} \
${SB_VAR_LIBGD+${CC_LD_RT}${SB_VAR_LIBGD_LIB}} \
${SB_VAR_ZLIB+${CC_LD_RT}${SB_VAR_ZLIB_LIB}} \
${LDFLAGS+${LDFLAGS}}" \
PKG_CONFIG_PATH="${SB_VAR_LUA_LIB}/pkgconfig" \
${SB_VAR_LIBGD+--with-gd=${SB_VAR_LIBGD}} \
${SB_VAR_LIBPNG+--with-png=${SB_VAR_LIBPNG}} \
--datarootdir=${_datadir} --datadir=${_datadir} \
--with-gihdir=${_datadir} --x-includes="${X_INCLUDES:-NONE}" \
--x-libraries="${X_LIBRARIES:-NONE}" --without-cairo \
--with-x --with-lasergnu --with-readline=bsd --without-cwdrc \
--disable-wxwidgets --without-lisp-files --without-pdf \
--with-row-help --enable-thin-splines --disable-dependency-tracking \
${ARGS+${ARGS}} --infodir="${SB_INSTALL_PREFIX}/info" \
--mandir="${SB_INSTALL_PREFIX}/man" \
--prefix=${SB_INSTALL_PREFIX}
]]>
      </configure>

      <build>
<![CDATA[
gmake pkglibexecdir="${SB_INSTALL_PREFIX}/libexec" && \
gmake -C docs pdf ps info ms && \
gmake -C tutorial tutorial.pdf tutorial.ps
]]>
      </build>

      <test auto-include="0">
<![CDATA[
# Prints lots of pretty graphs to the terminal
GNUTERM=dumb gmake check
]]>
      </test>

      <install>
<![CDATA[
${SB_PATH_INSTALL} -m 755 -o root -g 0 -d ${SB_INSTALL_PREFIX}/bin

gmake install pkglibexecdir="${SB_INSTALL_PREFIX}/libexec"

${SB_PATH_INSTALL} -m 755 -o root -g 0 src/lasergnu \
${SB_INSTALL_PREFIX}/bin

# install demo files
${SB_PATH_INSTALL} -m 755 -o root -g 0 -d \
${SB_INSTALL_PREFIX}/contrib/demo
${SB_PATH_INSTALL} -m 644 -o root -g 0 demo/binary? demo/*.cor \
demo/*.dat demo/*.dem demo/*.fnc demo/*.inc demo/*.par demo/*.rot \
${SB_INSTALL_PREFIX}/contrib/demo

${SB_PATH_INSTALL} -m 755 -o root -g 0 -d ${_docdir}/texinfo
${SB_PATH_INSTALL} -m 644 -o root -g 0 docs/gnuplot.texi \
${_docdir}/texinfo
(for _doc in gnuplot.ms gnuplot.pdf gnuplot.ps gpcard.ps titlepag.ms; do
  ${SB_PATH_INSTALL} -m 644 -o root -g 0 docs/${_doc} ${_docdir}
done
for _doc in tutorial.pdf tutorial.ps; do
  ${SB_PATH_INSTALL} -m 644 -o root -g 0 tutorial/${_doc} ${_docdir}
done)

${SB_PATH_INSTALL} -m 755 -o root -g 0 -d ${SB_INSTALL_PREFIX}/info
${SB_PATH_INSTALL} -m 755 -o root -g 0 docs/gnuplot.info \
${SB_INSTALL_PREFIX}/info
install-info docs/gnuplot.info ${SB_INSTALL_PREFIX}/info/dir
]]>
      </install>
    </module>

    <module name="python-2.6.7">
      <build-name>gnuplot-py-1.8</build-name>

      <sources>
        <source checksum="abd6f571e7aec68ae7db90a5217cd5b1"
          checksum-type="md5" size="118828"
          path="src/gnuplot-py-1.8.tar.gz"/>
      </sources>

      <dependencies>
        <depend program="python" var="PYTHON"
          install-name="python26">v&gt;=2.6.7</depend>
        <depend program="numpy" var="NUMPY" install-name="numpy16"
          module="2.6.7">v&gt;=1.6.1</depend>
      </dependencies>

      <script-header>
<![CDATA[
_pysubdir="python26"

_install_prefix="${SB_INSTALL_PREFIX_LIB}/${_pysubdir}"
]]>
      </script-header>

      <build>
<![CDATA[
PYTHONPATH="${SB_VAR_NUMPY_LIB}/${_pysubdir}" \
${SB_VAR_PYTHON}/bin/python setup.py build
]]>
      </build>

      <install>
<![CDATA[
${SB_PATH_INSTALL} -m 755 -o root -g 0 -d ${_install_prefix}

PYTHONPATH="${SB_VAR_NUMPY_LIB}/${_pysubdir}" \
${SB_VAR_PYTHON}/bin/python setup.py install --skip-build \
--install-lib=${_install_prefix} --prefix=${SB_INSTALL_PREFIX}

# install path for Python's include.paths.d
${SB_PATH_INSTALL} -m 755 -o root -g 0 -d \
${_install_prefix}/include.paths.d
cat >${_install_prefix}/include.paths.d/99-${SB_PROG_NAME} <<_EOT_
${_install_prefix}
_EOT_
]]>
      </install>

      <uninstall>
<![CDATA[
rm -rf ${_install_prefix}
]]>
      </uninstall>
    </module>

    <module name="python-2.7.2">
      <build-name>gnuplot-py-1.8</build-name>

      <sources>
        <source checksum="abd6f571e7aec68ae7db90a5217cd5b1"
          checksum-type="md5" size="118828"
          path="src/gnuplot-py-1.8.tar.gz"/>
      </sources>

      <dependencies>
        <depend program="python" var="PYTHON"
          install-name="python27">v&gt;=2.7.2</depend>
        <depend program="numpy" var="NUMPY" install-name="numpy16"
          module="2.7.2">v&gt;=1.6.1</depend>
      </dependencies>

      <script-header>
<![CDATA[
_pysubdir="python27"

_install_prefix="${SB_INSTALL_PREFIX_LIB}/${_pysubdir}"
]]>
      </script-header>

      <build>
<![CDATA[
PYTHONPATH="${SB_VAR_NUMPY_LIB}/${_pysubdir}" \
${SB_VAR_PYTHON}/bin/python setup.py build
]]>
      </build>

      <install>
<![CDATA[
${SB_PATH_INSTALL} -m 755 -o root -g 0 -d ${_install_prefix}

PYTHONPATH="${SB_VAR_NUMPY_LIB}/${_pysubdir}" \
${SB_VAR_PYTHON}/bin/python setup.py install --skip-build \
--install-lib=${_install_prefix} --prefix=${SB_INSTALL_PREFIX}

# install path for Python's include.paths.d
${SB_PATH_INSTALL} -m 755 -o root -g 0 -d \
${_install_prefix}/include.paths.d
cat >${_install_prefix}/include.paths.d/99-${SB_PROG_NAME} <<_EOT_
${_install_prefix}
_EOT_
]]>
      </install>

      <uninstall>
<![CDATA[
rm -rf ${_install_prefix}
]]>
      </uninstall>
    </module>

    <licenses>
      <license>
        <para>Copyright 1986 - 1993, 1998, 2004 Thomas Williams,
Colin Kelley</para>
        <para>Permission to use, copy, and distribute this software
and its documentation for any purpose with or without fee is hereby
granted, provided that the above copyright notice appear in all copies
and that both that copyright notice and this permission notice appear
in supporting documentation.</para>
        <para>Permission to modify the software is granted, but not
the right to distribute the complete modified source code.
Modifications are to be distributed as patches to the released
version. Permission to distribute binaries produced by compiling
modified sources is granted, provided you</para>
        <unorderedlist>
          <item><para>distribute the corresponding source
modifications from the released version in the form of a patch file
along with the binaries,</para></item>
          <item><para>add special version identification to
distinguish your version in addition to the base release version
number,</para></item>
          <item><para>provide your name and address as the primary
contact for the support of your modified version, and</para></item>
          <item><para>retain our contact information in regard to use
of the base software.</para></item>
        </unorderedlist>

        <para>Permission to distribute the released version of the
source code along with corresponding source modifications in the form
of a patch file is granted with same provisions 2 through 4 for binary
distributions.</para>
        <para>This software is provided "as is" without express or
implied warranty to the extent permitted by applicable law.</para>
      </license>
    </licenses>

    <notes>
      <change from="4.4.3" to="4.4.4">
        <item><para>NEW boxxyerrors plot style now allows variable
color</para></item>
        <item><para>NEW splot with pm3d now allows variable rgb
color</para></item>
        <item><para>NEW "nonuniform matrix" indicates ascii data with
explicit x, y</para></item>
        <item><para>CHANGE columnhead(N) is a string-valued function,
not a keyword</para></item>
        <item><para>CHANGE Demarcate plots in svg output using &lt;g
id="Plot_#"&gt;&lt;title&gt;...</para></item>
        <item><para>CHANGE xticlabels() works for binary data files as
well as ascii</para></item>
        <item><para>CHANGE "set key maxrows" now applies to 3D plots
as well as 2D</para></item>
        <item><para>CHANGE rewrite installation path rules for TeX
files</para></item>
        <item><para>FIX wxt terminal should now work on at least some
flavors of OSX</para></item>
        <item><para>FIX incorrect space allowed for outside left key
box</para></item>
        <item><para>FIX buffer overflow from enhanced text timefmt tic
labels</para></item>
        <item><para>FIX correction for offset in epochs when reading
in time format "%s"</para></item>
        <item><para>FIX discontinuity in defined palette limited by
maxcolors</para></item>
        <item><para>FIX initialization of svg pattern-fill
definitions</para></item>
        <item><para>FIX positioning of histogram bars when some data
entries are missing</para></item>
        <item><para>FIX emf terminal can handle UTF-8
encoding</para></item>
        <item><para>FIX User-specified axis tick labels override auto
labels in 3D just as in 2D</para></item>
        <item><para>FIX `plot with labels` failed to skip labels with
UNDEFINED coords</para></item>
        <item><para>FIX NaN (not a number) implementation for Windows
build</para></item>
        <item><para>FIX work-around for poor scaling in pdfcairo
pattern fill</para></item>
        <item><para>FIX segfault if mismatch between palette sizes of
successive terminals</para></item>
      </change>

      <change from="4.4.2" to="4.4.3">
        <item><para>NEW set key maxcolumns N maxrows M</para></item>
        <item><para>NEW value("varname") returns the value of the
named variable</para></item>
        <item><para>NEW encoding cp1251 - 8-bit Cyrillic</para></item>
        <item><para>NEW Implement pan and zoom via mouse
wheel.</para></item>
        <item><para>CHANGE backport emf terminal driver from version
4.5</para></item>
        <item><para>FIX better estimation of latex string
lengths</para></item>
        <item><para>FIX colorbar representation of discrete color
palettes is pixel accurate</para></item>
        <item><para>FIX NaN initialization and tests working on more
(all?) platforms</para></item>
        <item><para>FIX configuration script tests for
readline+ncurses</para></item>
        <item><para>FIX prevent out-of-range boxes from creating
degenerate ghosts on the border</para></item>
        <item><para>FIX missing alpha channel flag for pdfcairo
terminal</para></item>
        <item><para>FIX font initialization in windows
terminal</para></item>
      </change>

      <change from="4.4.1" to="4.4.2">
        <item><para>FIX error in clipping filled curves to plot
boundary</para></item>
        <item><para>FIX regression in colorspec parsing ("lc N" not
recognized)</para></item>
        <item><para>FIX prevent segfault if refresh follows
interrupted replot</para></item>
      </change>

      <change from="4.4.0" to="4.4.1">
        <item><para>NEW Support the "%s" format specifier in
strftime()</para></item>
        <item><para>NEW Optional 6th data column in candlesticks style
to specific box width</para></item>
        <item><para>NEW If integer arithmetic i*j or i**j would
overflow, return value as a real</para></item>
        <item><para>NEW "set style circle radius
&lt;default-radius&gt;"</para></item>
        <item><para>FIX autoconfiguration of readline support in
OSX</para></item>
        <item><para>FIX font problems in win terminal </para></item>
        <item><para>FIX Protect against runaway recursion by limiting
depth of nested functions</para></item>
        <item><para>FIX metapost terminal: Fix inheritance of line
thickness by text strings</para></item>
        <item><para>FIX cairo terminals could segfault on certain
enhanced text strings</para></item>
        <item><para>FIX pdfcairo output to stdout now
works</para></item>
        <item><para>FIX font ",size" in non-enhanced mode postscript
terminals</para></item>
        <item><para>FIX Do a better job of estimating the width of
UTF-8 encoded strings</para></item>
        <item><para>FIX baseline bug in canvas terminal rotation of
enhanced text</para></item>
        <item><para>FIX Allow "with labels" to work for binary input
data</para></item>
        <item><para>FIX update user GPVAL variables after plot in
table mode</para></item>
        <item><para>CHANGE depth-sorting of pm3d surfaces now applies
jointly to all in the plot</para></item>
        <item><para>CHANGE 3D impulses are now always drawn from
z=0</para></item>
        <item><para>CHANGE Enable HIDDEN_QUADTREE by
default</para></item>
        <item><para>CHANGE Enable "set fit errorvariables" by
default</para></item>
        <item><para>CHANGE Regardless of current timefmt, read time
from binary files as a binary</para></item>
        <item><para>CHANGE do not limit 3D rotation to
0&lt;rotx&lt;180</para></item>
      </change>

      <note type="compilation">
        <para>GIF support is no long available. GNU plotutils support
is no longer available because the Gnuplot license is incompatible
with GPL.</para>
      </note>

      <note type="usage">
        <para>Various demo scripts are available in
<command>${SB_INSTALL_PREFIX}/contrib/demo</command>.</para>
        <para>The Gnuplot Python binding is available in the following
directories:</para>
        <screen>
${SB_INSTALL_PREFIX}/lib/python26    # Python 2.6.7
${SB_INSTALL_PREFIX}/lib/python27    # Python 2.7.2
        </screen>

        <para>The directory is automatically added to the correct
Python include.paths.d directory by the postinstall script. Installing
Gnuplot will not automatically install Python or Numpy. Both of these
packages must be installed separately for the Gnuplot binding to
work.</para>
      </note>
    </notes>
  </program>
</programs>

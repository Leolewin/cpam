<?xml version="1.0"?>
<programs>
<!DOCTYPE programs SYSTEM "sb-db.dtd">
  <program name="libwmf" version="0.2.8" revision="18">
    <build-name>${SB_PROG_NAME}-${SB_PROG_VER}.4</build-name>

    <install-name>${SB_PROG_NAME}02</install-name>

    <sources>
      <source checksum="d1177739bf1ceb07f57421f0cee191e0"
        checksum-type="md5" size="2169375"
        path="src/libwmf-0.2.8.4.tar.gz"/>
      <patch checksum="4ddec176c9f819760a44808401ee6e57"
        checksum-type="md5" size="1026"
        path="src/libwmf-0.2.8.4.CVE-2006-3376.patch"/>
      <patch checksum="8a293c1ad55b9159d8d6fa11fc1e884f"
        checksum-type="md5" size="352292"
        path="src/libwmf-0.2.8.4.tww.patch"/>
      <patch checksum="7a34ecb8bb137dc54c0c082a80fba1ec"
        checksum-type="md5" size="2189349"
        path="src/libwmf-0.2.8.4.auto.patch"/>
    </sources>

    <dependencies>
      <depend program="ghostscript" var="GHOSTSCRIPT"
        install-name="ghostscript90">v&gt;=9.01</depend>
      <depend program="pkgconfig" install-name="pkgconfig02"
        add-path="prepend" type="build">v&gt;=0.25</depend>
      <depend program="expat" var="LIBEXPAT"
        install-name="libexpat20">v&gt;=2.0.1</depend>
      <depend program="freetype" var="LIBTTF"
        install-name="libttf24">v&gt;=2.4.6</depend>
      <depend program="jpeg" var="JPEG"
        install-name="libjpeg8">v&gt;=8b</depend>
      <depend program="libpng" var="LIBPNG"
        install-name="libpng14">v&gt;=1.4.4</depend>
      <depend program="plotutils" var="PLOTUTILS"
        install-name="plotutils26">v&gt;=2.6</depend>
      <depend program="xpm" var="XPM"
        install-name="xpm">v&gt;=3.4k</depend>
      <depend program="zlib" var="ZLIB"
        install-name="libz12">v&gt;=1.2.5</depend>
    </dependencies>

    <script-header>
<![CDATA[
if [ "${SB_VAR_GHOSTSCRIPT+set}" = set ]; then
  _gs_datadir="${SB_VAR_GHOSTSCRIPT}/share"
fi
_datadir="${SB_INSTALL_PREFIX}/share"
_docdir="${SB_INSTALL_PREFIX}/doc"
]]>
    </script-header>

    <configure>
<![CDATA[
case "${SB_SYSTYPE}" in
*-aix*)
  CC=xlc CFLAGS="-O2 -qro -qroconst -qmaxmem=-1 -qarch=com"
  LDFLAGS="-Wl,-brtl -Wl,-blibpath:/usr/lib"
  CC_LD_RT="-Wl,-blibpath:" ;;
ia64*-hpux*)
  CC=cc CFLAGS="-z +O2 +Ofltacc +Olit=all +Oentrysched \
+Odataprefetch +Onolimit"
  CC_LD_RT="-Wl,+b," ;;
*-hpux10*)
  CPP="cc -Ae -E"
  CC="cc -Ae" CFLAGS="-z +O2 +ESlit +Ofltacc +DAportable \
+Oentrysched +Odataprefetch +Onolimit"
  CC_LD_RT="-Wl,+s,+b," ;;
*-hpux11.[01]*)
  CC="cc" CFLAGS="-z +O2 +Olit=all +Ofltacc +DAportable \
+Oentrysched +Odataprefetch +Onolimit"
  CC_LD_RT="-Wl,+s,+b," ;;
*-hpux11*)
  CC=cc CFLAGS="-z +O2 +Ofltacc +Olit=all +Oentrysched \
+Odataprefetch +Onolimit"
  CC_LD_RT="-Wl,+s,+b," ;;
*-irix*)
  CC=cc CFLAGS="-Wl,-woff,84 -Wl,-woff,85 -woff 1429 \
-use_readonly_const -G0 -rdata_shared -DEBUG:optimize_space=ON \
-O2 -OPT:Olimit=0"
  CC_LD_RT="-Wl,-rpath," ;;
i?86*-linuxe3)
  CFLAGS="-O2 -mcpu=pentiumpro -march=pentiumpro"
  CC_LD_RT="-Wl,-rpath," ;;
i?86*-linux*)
  CFLAGS="-O2 -mtune=pentiumpro -march=pentiumpro"
  CC_LD_RT="-Wl,-rpath," ;;
*-linux*)
  CC_LD_RT="-Wl,-rpath," ;;
*-osf*)
  CC=cc CFLAGS="-O2 -ieee -msym -readonly_strings"
  CC_LD_RT="-Wl,-rpath," ;;
i?86*-solaris*)
  CC=cc CFLAGS="-mr -Qn -xstrconst -xO2 -xtarget=pentium4"
  CC_LD_RT="-R" ;;
*-solaris2.8)
  CC=cc CFLAGS="-mr -Qn -xstrconst -xO2 -xtarget=ultra2 \
-xarch=v8plusa"
  CC_LD_RT=-R ;;
*-solaris*)
  CC=cc CFLAGS="-mr -Qn -xstrconst -xO2 -xtarget=ultra2 \
-m32 -xarch=sparcvis"
  CC_LD_RT=-R ;;
esac

${SHELL} ./configure CC="${CC:-gcc}" CFLAGS="${CFLAGS:--O2}" \
CPPFLAGS="-I${SB_VAR_LIBEXPAT_INC} -L${SB_VAR_PLOTUTILS_INC} \
${CPPFLAGS+${CPPFLAGS}}" CPP="${CPP+${CPP}}" \
LDFLAGS="${SB_VAR_XPM+-L${SB_VAR_XPM_LIB}} \
-L${SB_VAR_LIBEXPAT_LIB} -L${SB_VAR_PLOTUTILS_LIB} \
${CC_LD_RT}${SB_VAR_PLOTUTILS_LIB}:${SB_VAR_LIBEXPAT_LIB}\
${SB_VAR_XPM+:${SB_VAR_XPM_LIB}} ${LDFLAGS+${LDFLAGS}}" \
PKG_CONFIG_PATH="\
${SB_VAR_LIBTTF+${SB_VAR_LIBTTF_LIB}/pkgconfig:}\
${SB_VAR_ZLIB+${SB_VAR_ZLIB_LIB}/pkgconfig:}\
${SB_VAR_JPEG+${SB_VAR_JPEG_LIB}/pkgconfig:}\
${SB_VAR_LIBPNG+${SB_VAR_LIBPNG_LIB}/pkgconfig}" \
${SB_VAR_GHOSTSCRIPT+--with-gsfontmap="${_gs_datadir}/lib/Fontmap"} \
${SB_VAR_GHOSTSCRIPT+--with-gsfontdir="${_gs_datadir}/fonts"} \
--with-expat=${SB_VAR_LIBEXPAT} --with-fontdir="${_datadir}/fonts" \
--with-xtrafontmap="${_datadir}/fonts/fontmap" \
--without-gdk-plugin --with-docdir=${_docdir} \
--datadir=${_datadir} --disable-dependency-tracking \
--libdir=${SB_INSTALL_PREFIX_LIB} --prefix=${SB_INSTALL_PREFIX}

${SB_PATH_SED} -i -e "\
s|=-L\(\${exec_prefix}/lib\)$|=\"-L\1 ${CC_LD_RT}\1\"|;" libwmf-config
]]>
    </configure>

    <build>
<![CDATA[
gmake pkgdatadir="${_datadir}"
]]>
    </build>

    <install>
<![CDATA[
gmake install pkgdatadir="${_datadir}"
]]>
    </install>

    <licenses>
      <license path="lgpl-2.license"/>
    </licenses>

    <changelog>
      <change date="2011 May 5" revision="18"
      author="Gary V. Vaughan" email="gary@thewrittenword.com">
        <item><para>Update freetype dependency from 2.3.7 to
2.4.6</para></item>
        <item><para>Update ghostscript dependency from 8.63 to
9.01</para></item>
        <item><para>Update jpeg dependency from 6b to
8b</para></item>
        <item><para>Update libpng dependency from 1.2.9 to
1.4.4</para></item>
        <item><para>Update pkgconfig dependency from 0.23 to
0.25</para></item>
        <item><para>Update plotutils dependency from 2.5 to
2.6</para></item>
        <item><para>Update zlib dependency from 1.2.3 to
1.2.5</para></item>
      </change>

      <change date="2010 October 29" revision="17"
      author="Albert Chin-A-Young" email="china@thewrittenword.com">
        <item><para>Add support for RHEL 6</para></item>
      </change>

      <change date="2009 June 4" revision="16"
      author="Albert Chin-A-Young" email="china@thewrittenword.com">
        <item><para>Add support for AIX 6.1</para></item>
      </change>

      <change date="2009 February 13" revision="15"
      author="Albert Chin-A-Young" email="china@thewrittenword.com">
        <item><para>Add support for SLES 10</para></item>
      </change>

      <change date="2008 December 15" revision="14"
      author="Gary V. Vaughan" email="gary@thewrittenword.com">
        <item><para>Update ghostscript dependency from 8.57 to
8.63</para></item>
        <item><para>Update pkgconfig dependency from 0.21 to
0.23</para></item>
        <item><para>Update freetype dependency from 2.3.5 to
2.3.7</para></item>
        <item><para>Update libpng dependency from 1.2.18 to
1.2.29</para></item>
        <item><para>Use +Ofltacc compiler optimisation flag on hpux
instead of +Onofltacc</para></item>
        <item><para>Update flags for latest Sun compilers on
Solaris 9 and 10</para></item>
      </change>

      <change date="2007 September 10" revision="13"
      author="Albert Chin-A-Young" email="china@thewrittenword.com">
        <item><para>Update expat dependency from 1.95.8 to
2.0.1</para></item>
        <item><para>Update ghostscript dependency from 7.07 to
8.57</para></item>
        <item><para>Update libpng dependency from 1.2.4 to
1.2.18</para></item>
        <item><para>Update plotutils dependency from 2.4.1 to
2.5</para></item>
        <item><para>Update zlib dependency from 1.1.4 to
1.2.3</para></item>
      </change>

      <change date="2007 August 1" revision="12"
      author="Axel Thimm" email="thimm@thewrittenword.com">
        <item><para>Update freetype dependency from 2.1.9 to
2.3.5</para></item>
      </change>

      <change date="2007 May 3" revision="11"
      author="Albert Chin-A-Young" email="china@thewrittenword.com">
        <item><para>Add support for RHEL 5</para></item>
      </change>

      <change date="2006 July 14" revision="10"
      author="Albert Chin-A-Young" email="china@thewrittenword.com">
        <item><para>Update to libtool-1.5-17</para></item>
        <item><para>Apply patch for CVE-2006-3376 (<ulink url="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-3376">http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-3376</ulink>).
An integer overflow exists in <command>player.c</command>, allowing
remote attackers to execute arbitrary code via the
<command>MaxRecordSize</command> header field in a WMF
file.</para></item>
      </change>

      <change date="2006 June 16" revision="9"
      author="Albert Chin-A-Young" email="china@thewrittenword.com">
        <item><para>Add support for Solaris 10/x86</para></item>
      </change>

      <change date="2005 December 25" revision="8"
      author="Albert Chin-A-Young" email="china@thewrittenword.com">
        <item><para>Add support for HP-UX 11.23/IA-64</para></item>
        <item><para>Update pkgconfig dependency from 0.15.0 to
0.20</para></item>
        <item><para>Update to libtool-1.5-14</para></item>
      </change>

      <change date="2005 October 3" revision="7"
      author="Albert Chin-A-Young" email="china@thewrittenword.com">
        <item><para>Add support for HP-UX 11.23/PA-RISC</para></item>
      </change>

      <change date="2005 April 30" revision="6"
      author="Albert Chin-A-Young" email="china@thewrittenword.com">
        <item><para>Add support for Solaris 10/SPARC</para></item>
      </change>

      <change date="2005 January 29" revision="5"
      author="Albert Chin-A-Young" email="china@thewrittenword.com">
        <item><para>Don't include &lt;freetype/freetype.h&gt;. Include
ft2build.h and then FT_FREETYPE_H</para></item>
        <item><para>Upgrade to libtool-1.5-6</para></item>
        <item><para>Upgrade expat dependency from 1.95.6 to
1.95.8</para></item>
        <item><para>Upgrade freetype dependency from 2.1.4 to
2.1.9</para></item>
      </change>

      <change date="2004 August 27" revision="4"
      author="Albert Chin-A-Young" email="china@thewrittenword.com">
        <item><para>Upgrade to libtool-1.5-4</para></item>
      </change>

      <change date="2004 July 30" revision="3"
      author="Albert Chin-A-Young" email="china@thewrittenword.com">
        <item><para>Upgrade included trio library to latest
release to avoid use of nan() and strtof() on Tru64 UNIX
4.0D</para></item>
      </change>

      <change date="2004 January 14" revision="2"
      author="Albert Chin-A-Young" email="china@thewrittenword.com">
        <item><para>Upgrade Perl dependency to 5.8.2</para></item>
        <item><para>Upgrade Ghostscript dependency to
7.07</para></item>
      </change>

      <change date="2003 June 23" revision="1"
      author="Albert Chin-A-Young" email="china@thewrittenword.com">
        <item><para>Add support for AIX 5.1 (same as AIX
4)</para></item>
      </change>
    </changelog>
  </program>
</programs>

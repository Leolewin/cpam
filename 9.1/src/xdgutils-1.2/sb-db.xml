<?xml version="1.0"?>
<programs>
<!DOCTYPE programs SYSTEM "sb-db.dtd">
  <program name="xdgutils" version="1.2" revision="1">
    <install-name>${SB_PROG_NAME}12</install-name>

    <module name="desktop-file-utils">
      <build-name>${SB_MODULE_NAME}-0.18</build-name>

      <sources>
        <source checksum="d966b743eb394650f98d5dd56b9aece1"
          checksum-type="md5" size="256340"
          path="src/desktop-file-utils-0.18.tar.bz2"/>
        <patch checksum="0aebd12abb9f3343b04fc4e92d8a3c39"
          checksum-type="md5" size="7194"
          path="src/desktop-file-utils-0.18.tww.patch"/>
        <patch checksum="b10fe88fc6bbbcc4fde9a5e02bdb9d28"
          checksum-type="md5" size="1582120"
          path="src/desktop-file-utils-0.18.auto.patch"/>
      </sources>

      <dependencies>
        <depend program="pkgconfig" install-name="pkgconfig02"
          add-path="prepend" type="build">v&gt;=0.25</depend>
        <depend program="gettext" var="GETTEXT"
          install-name="gettext018"
          add-path="prepend">v&gt;=0.18.1.1</depend>
        <depend program="glib" var="LIBGLIB" install-name="libglib226"
          add-path="prepend">v&gt;=2.26.1</depend>
        <depend program="libiconv" var="LIBICONV"
          install-name="libiconv113"
          add-path="prepend">v&gt;=1.13.1</depend>
      </dependencies>

      <configure>
<![CDATA[
case "${SB_SYSTYPE}" in
*-aix*)
  CC=xlc_r CFLAGS="-O2 -qlanglvl=extc99 -qmaxmem=-1 -qarch=ppc"
  LDFLAGS="-Wl,-brtl -Wl,-blibpath:/usr/lib"
  CC_LD_RT="-Wl,-blibpath:" ;;
ia64*-hpux*)
  CC=cc CFLAGS="-z +O2 +Ofltacc +Olit=all +Oentrysched \
+Odataprefetch +Onolimit"
  CC_LD_RT="-Wl,+b," ;;
*-hpux11.[01]*)
  CC=cc CFLAGS="-z +O2 +Ofltacc +Olit=all +DAportable \
+Oentrysched +Odataprefetch +Onolimit"
  CC_LD_RT="-Wl,+s,+b," ;;
*-hpux*)
  CC=cc CFLAGS="-z +O2 +Ofltacc +Olit=all +Oentrysched \
+Odataprefetch +Onolimit"
  CC_LD_RT="-Wl,+s,+b," ;;
*-irix*)
  CC=c99 CFLAGS="-Wl,-woff,84 -Wl,-woff,85 -woff 1429 \
-use_readonly_const -G0 -rdata_shared -DEBUG:optimize_space=ON \
-O2 -OPT:Olimit=0"
  CC_LD_RT="-Wl,-rpath," ;;
i?86*-linux*)
  CFLAGS="-O2 -mtune=pentiumpro -march=pentiumpro"
  CC_LD_RT="-Wl,-rpath," ;;
*-linux*)
  CC_LD_RT="-Wl,-rpath," ;;
*-osf*)
  CC=cc CFLAGS="-O2 -arch ev5 -msym -readonly_strings"
  CC_LD_RT="-Wl,-rpath," ;;
i?86*-solaris*)
  CC=cc CFLAGS="-mr -Qn -xstrconst -xO2 -xtarget=pentium4"
  CC_LD_RT="-R" ;;
*-solaris2.8)
  CC=cc CFLAGS="-mr -Qn -xstrconst -xO2 -xtarget=ultra2 \
-xarch=v8plusa"
  CC_LD_RT="-R" ;;
*-solaris*)
  CC=cc CFLAGS="-mr -Qn -xstrconst -xO2 -xtarget=ultra2 \
-m32 -xarch=sparcvis"
  CC_LD_RT="-R" ;;
esac

${SHELL} ./configure CC="${CC:-gcc}" CFLAGS="${CFLAGS:--O2}" \
${LDFLAGS+LDFLAGS="${LDFLAGS}"} \
PKG_CONFIG_PATH="${SB_VAR_LIBGLIB+${SB_VAR_LIBGLIB}/lib/pkgconfig:}\
${SB_VAR_GETTEXT+${SB_VAR_GETTEXT_LIB}/pkgconfig:}\
${SB_VAR_LIBICONV+${SB_VAR_LIBICONV_LIB}/pkgconfig}" \
EMACS=no --enable-static --enable-shared \
--disable-dependency-tracking --mandir="${SB_INSTALL_PREFIX}/man" \
--prefix=${SB_INSTALL_PREFIX}
]]>
      </configure>
    </module>

    <licenses>
      <license path="gpl-2.license"/>
    </licenses>

    <notes name="desktop-file-utils">
      <change from="0.17" to="0.18">
        <items name="desktop-file-validate">
          <item><para>accept x-scheme-handler/* mime
types</para></item>
        </items>

        <items name="update-desktop-database">
          <item><para>sort mime types alphabetically in generated
cache</para></item>
          <item><para>accept x-scheme-handler/* mime
types</para></item>
        </items>

        <items name="misc">
          <item><para>improve build system</para></item>
          <item><para>minor documentation fixes</para></item>
        </items>
      </change>

      <change from="0.16" to="0.17">
        <items name="desktop-file-validate">
          <item><para>accept chemical/* mime types as valid
types</para></item>
          <item><para>make icon names with an extension for Icon key a
non-fatal error</para></item>
        </items>

        <items name="update-desktop-database">
          <item><para>accept chemical/* mime types as valid
types</para></item>
          <item><para>ignore --verbose if --quiet is also
passed</para></item>
          <item><para>make sure to always output lists in the keyfile
we generate</para></item>
        </items>

        <items name="misc">
          <item><para>improve build system</para></item>
          <item><para>update documentation</para></item>
          <item><para>add man pages</para></item>
        </items>
      </change>

      <change from="0.15" to="0.16">
        <items name="desktop-file-install">
          <item><para>do not unlink the destination file if it's the
same as the source file in desktop-file-install</para></item>
        </items>

        <items name="desktop-file-validate">
          <item><para>check that a main category is included in the
Categories</para></item>
          <item><para>check that categories required by another one
are present</para></item>
          <item><para>do not always show warnings about KDE specific
uses</para></item>
          <item><para>check that the Comment does not look like the
Name and the GenericName</para></item>
          <item><para>display error about multiple keys with the same
name earlier</para></item>
          <item><para>improve MIME type check to make sure that the
MIME types are valid</para></item>
          <item><para>add LXDE in the list of registered OnlyShowIn
values</para></item>
          <item><para>add "warning" to error strings to make them
easily greppable</para></item>
          <item><para>handle AutostartCondition key, as proposed for
the autostart specification and used in GNOME</para></item>
          <item><para>accept empty Categories key as
valid</para></item>
          <item><para>make new errors non-fatal to give some time to
maintainers to fix their .desktop file after a release of
desktop-file-utils</para></item>
          <item><para>plug leak</para></item>
          <item><para>code cleanups</para></item>
        </items>

        <items name="update-desktop-database">
          <item><para>improve MIME type check to make sure that the
MIME types are valid</para></item>
          <item><para>improve error messages</para></item>
          <item><para>fix format string vulnerability
warning</para></item>
        </items>

        <items name="misc">
          <item><para>use AM_SILENT_RULES</para></item>
          <item><para>improve build system</para></item>
        </items>
      </change>

      <change from="0.14" to="0.15">
        <item><para>make the extension check for Icon key a warning
instead of an error for now </para></item>
        <item><para>Fix a crash in update-desktop-database when
there's no group</para></item>
        <item><para>Fix a crash in the validator happening for very
small lines</para></item>
      </change>
    </notes>
  </program>
</programs>

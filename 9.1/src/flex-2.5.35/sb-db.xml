<?xml version="1.0"?>
<programs>
<!DOCTYPE programs SYSTEM "sb-db.dtd">
  <program name="flex" version="2.5.35" revision="5">
    <build-name>${SB_PROG_NAME}-2.5.35</build-name>

    <install-name>${SB_PROG_NAME}25</install-name>

    <sources>
      <source checksum="10714e50cea54dc7a227e3eddcd44d57"
        checksum-type="md5" size="1256501"
        path="src/flex-2.5.35.tar.bz2"/>
      <patch checksum="547d7c49e2fdaa751d6b7990bc45a0c3"
        checksum-type="md5" size="555"
        path="src/flex-2.5.35.fc-sign.patch"/>
      <patch checksum="8151aa0c3a2d34904dfdf14c751a6614"
        checksum-type="md5" size="9287"
        path="src/flex-2.5.35.tww.patch"/>
      <patch checksum="7e79dcd1638e0ecfbd883bd8f5ba5c68"
        checksum-type="md5" size="2096108"
        path="src/flex-2.5.35.auto.patch"/>
    </sources>

    <dependencies>
      <depend program="bison" install-name="bison24"
        add-path="prepend" type="build">v&gt;=2.4.3</depend>
      <depend program="indent" install-name="indent22"
        add-path="prepend">v&gt;=2.2.11</depend>
      <depend program="m4" var="M4"
        install-name="m414">v&gt;=1.4.15</depend>
      <depend program="gettext" var="GETTEXT"
        install-name="gettext018"
        add-path="prepend">v&gt;=0.18.1.1</depend>
      <depend program="libiconv" var="LIBICONV"
        install-name="libiconv113"
        add-path="prepend">v&gt;=1.13.1</depend>
    </dependencies>

    <script-header>
<![CDATA[
_docdir="${SB_INSTALL_PREFIX}/doc"
_datadir="${SB_INSTALL_PREFIX}/share"

_m4="${SB_VAR_M4}/bin/gm4"
]]>
    </script-header>

    <configure>
<![CDATA[
case "${SB_SYSTYPE}" in
*-aix*)
  CC=xlc CFLAGS="-O2 -qro -qroconst -qmaxmem=-1 -qarch=ppc"
  CXX=xlC CXXFLAGS="-O2 -qro -qroconst -qnotempinc \
-qnotemplateregistry -qmaxmem=-1 -qarch=ppc" ;;
*-hpux11.[01]*)
  CC=cc CFLAGS="-z +O2 +Ofltacc +Olit=all +DAportable \
+Oentrysched +Odataprefetch +Onolimit"
  CXX=aCC CXXFLAGS="-AA -z +O2 +Ofltacc +Olit=all +DAportable \
+Oentrysched +Odataprefetch" ;;
*-hpux10*)
  CC=cc CFLAGS="-Ae -z +O2 +Ofltacc +ESlit +DAportable \
+Oentrysched +Odataprefetch +Onolimit" ;;
*-hpux*)
  CC=cc CFLAGS="-z +O2 +Ofltacc +Olit=all +Oentrysched \
+Odataprefetch +Onolimit"
  CXX=aCC CXXFLAGS="-AA -z +O2 +Ofltacc +Olit=all +Oentrysched \
+Odataprefetch" ;;
*-irix*)
  CC=cc CFLAGS="-Wl,-woff,84 -Wl,-woff,85 -woff 1429 \
-use_readonly_const -G0 -rdata_shared -DEBUG:optimize_space=ON \
-O2 -OPT:Olimit=0"
  CXX=CC CXXFLAGS="-Wl,-woff,84 -Wl,-woff,85 -woff 1429 \
-use_readonly_const -G0 -rdata_shared -DEBUG:optimize_space=ON \
-ptused -FE:template_in_elf_section -O2 -OPT:Olimit=0" ;;
i?86*-linux*)
  CFLAGS="-O2 -mtune=pentiumpro -march=pentiumpro"
  CXXFLAGS="-O2 -mtune=pentiumpro -march=pentiumpro" ;;
*-osf*)
  CC=cc CFLAGS="-O2 -arch ev5 -msym -readonly_strings"
  CXX=cxx CXXFLAGS="-O2 -arch ev5 -model ansi -msym \
-readonly_strings -timplicit_local -D__USE_STD_IOSTREAM" ;;
i?86*-solaris*)
  CC=cc CFLAGS="-mr -Qn -xstrconst -xO2 -xtarget=pentium4"
  CXX=CC CXXFLAGS="-xO2 -xtarget=pentium4" ;;
*-solaris2.8)
  CC=cc CFLAGS="-mr -Qn -xstrconst -xO2 -xtarget=ultra2 \
-xarch=v8plusa"
  CXX=CC CXXFLAGS="-xO2 -xtarget=ultra2 -xarch=v8plusa" ;;
*-solaris*)
  CC=cc CFLAGS="-mr -Qn -xstrconst -xO2 -xtarget=ultra2 \
-m32 -xarch=sparcvis"
  CXX=CC CXXFLAGS="-xO2 -xtarget=ultra2 -m32 -xarch=sparcvis" ;;
esac

${SHELL} ./configure CC="${CC:-gcc}" CFLAGS="${CFLAGS:--O2}" \
CXX="${CXX:-g++}" CXXFLAGS="${CXXFLAGS:--O2}" \
${SB_VAR_GETTEXT+--with-libintl-prefix=${SB_VAR_GETTEXT}} \
${SB_VAR_LIBICONV+--with-libiconv-prefix=${SB_VAR_LIBICONV}} \
M4=${_m4} --disable-dependency-tracking \
--datarootdir=${_datadir} --datadir=${_datadir} \
--infodir="${SB_INSTALL_PREFIX}/info" \
--libdir=${SB_INSTALL_PREFIX_LIB} \
--mandir="${SB_INSTALL_PREFIX}/man" --prefix=${SB_INSTALL_PREFIX}

(rm doc/flex.info*) 2>/dev/null || :
]]>
    </configure>

    <test>
<![CDATA[
gmake check

# ignore failures
:
]]>
    </test>

    <install>
<![CDATA[
gmake install

${SB_PATH_INSTALL} -m 755 -o root -g 0 -d ${_docdir}/texinfo
${SB_PATH_INSTALL} -m 644 -o root -g 0 doc/flex.texi \
doc/version.texi ${_docdir}/texinfo
]]>
    </install>

    <notes>
      <change from="2.5.34" to="2.5.35">
        <item><para>fixed bug that prevented flex from accepting
certain comments in the scanner file (resolves bugs #1849809 and
#1849805)</para></item>
        <item><para>fix bug that prevented headers for all functions
from being generated (resolves bug #1628314)</para></item>
        <item><para>change yy_size_t to be size_t (resolves bug
#1849812)</para></item>
        <item><para>new de, nl, pl, pt_br, vi translations from the
translation project</para></item>
      </change>

      <change from="2.5.32" to="2.5.34">
        <item><para>introduce yylex_init_extra; see the manual for
details</para></item>
        <item><para>introduce %option extra-type="your_type *"
(resolves bug #1744505)</para></item>
        <item><para>The flex program now parses multiple short
concatenated options (resolves bug #1619820)</para></item>
        <item><para>better checking after yyalloc/yyrealloc (resolves
bug #1595967)</para></item>
        <item><para>flex now provides for a libfl_pic.a compiled with
position independent code. Particularly useful when including a flex
scanner in a shared library and with more recent versions of
gcc.</para></item>
        <item><para>SourceForge feature request #1658379: Expose
YY_BUF_SIZE in the header file</para></item>
        <item><para>flex better escapes filenames with special
characters in them (resolves bug #1623600)</para></item>
        <item><para>a memory leak was plugged(resolves bug
#1601111)</para></item>
        <item><para>pattern language expanded; see the manual for
details on the below highlights</para>
        <unorderedlist>
          <item><para>pattern options added to specify patterns as
case-insensitive or case-sensitive</para></item>
          <item><para>pattern options to specify whether the "."
character should match the newline character</para></item>
          <item><para>pattern options added to allow ignoring of
whitespace in patterns</para></item>
          <item><para>POSIX character classes may be negated in
patterns</para></item>
          <item><para>patterns may now use set difference, union
operators</para></item>
        </unorderedlist></item>
        <item><para>the manual now contains an appendix listing
various common patterns which may be useful when writing
scanners</para></item>
        <item><para>some memory leaks were removed from the C++
scanner (but the C++ scanner is still experimental and may change
radically without notice)</para></item>
        <item><para>c++ scanners can now use yywrap</para></item>
        <item><para>added new unit test for c++ and
yywrap</para></item>
        <item><para>portability fixes to some unit tests</para></item>
        <item><para>flex man page and flex manual in pdf now
distributed in the flex distribution</para></item>
        <item><para>new ca, vi, ga, nl translations from the
translation project</para></item>
        <item><para>flex no longer comes with an rpm spec
file</para></item>
        <item><para>flex development now happens with automake
1.9.6</para></item>
      </change>

      <change from="2.5.31" to="2.5.32">
        <item><para>numerous bug and security fixes</para></item>
        <item><para>new nl, vi, sv, ro, po, ga, ca, fr, tr
translations from the translation project</para></item>
        <item><para>upgrade to use gettext 0.12 (this now makes the
"pdf" and "ps" targets in the build system able to be run
successfully)</para></item>
      </change>
    </notes>

    <changelog>
      <change date="2011 August 25" revision="5"
      author="Albert Chin-A-Young" email="china@thewrittenword.com">
        <item><para>Remove help2man dependency by generating
doc/flex.1 and adding it to auto.patch.</para></item>
      </change>

      <change date="2010 December 17" revision="4"
      author="Peter O'Gorman" email="pogma@thewrittenword.com">
        <item><para>Update gcc dependency from 4.2.4 to
4.4.5</para></item>
        <item><para>Update gettext dependency from 0.17 to
0.18.1.1</para></item>
        <item><para>Update libiconv dependency from 1.12 to
1.13.1</para></item>
        <item><para>Update bison dependency from 2.3 to
2.4.3</para></item>
        <item><para>Update help2man dependency from 1.36.4 to
1.38.2</para></item>
        <item><para>Update indent dependency from 2.2.9 to
2.2.11</para></item>
      </change>

      <change date="2010 October 29" revision="3"
      author="Peter O'Gorman" email="pogma@thewrittenword.com">
        <item><para>Add support for RHEL 6</para></item>
      </change>

      <change date="2010 June 19" revision="2"
      author="Albert Chin-A-Young" email="china@thewrittenword.com">
        <item><para>Remove indent on #define for YY_LESS_LINENO to
avoid error compiling on Tru64 UNIX with -nodtk</para></item>
      </change>
    </changelog>
  </program>
</programs>

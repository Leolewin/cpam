<?xml version="1.0"?>
<programs>
<!DOCTYPE programs SYSTEM "sb-db.dtd">
  <program name="tcsh" version="6.16" revision="3">
    <build-name>${SB_PROG_NAME}-${SB_PROG_VER}.00</build-name>

    <install-name>${SB_PROG_NAME}61</install-name>

    <sources>
      <source checksum="55f1a41512250168ec4bf1db0e246db4"
        checksum-type="md5" size="886468"
        path="src/tcsh-6.16.00.tar.gz"/>
      <patch checksum="d1ee62743189f3ba1a284ace06cfd912"
        checksum-type="md5" size="5799"
        path="src/tcsh-6.16.00.tww.patch"/>
      <patch checksum="14daaa69fd78f5ee1ebdaa9e3ddb7a09"
        checksum-type="md5" size="503575"
        path="src/tcsh-6.16.00.auto.patch"/>
    </sources>

    <dependencies>
      <depend program="bison" install-name="bison24"
        add-path="prepend" type="build">v&gt;=2.4.3</depend>
    </dependencies>

    <configure>
<![CDATA[
case "${SB_SYSTYPE}" in
*-aix*)
  CC=xlc CFLAGS="-O2 -qro -qroconst -qmaxmem=-1 -qarch=ppc" ;;
ia64*-hpux*)
  CC=cc CFLAGS="-z +O2 +Onofltacc +Olit=all +Oentrysched \
+Odataprefetch +Onolimit"
  LDFLAGS="-Wl,+nodefaultrpath" ;;
*-hpux11.[01]*)
  CC=cc CFLAGS="+O2 -Ae -z +ESlit +Onofltacc +DAportable \
+Oentrysched +Odataprefetch +Onolimit" ;;
*-hpux11*)
  CC=cc CFLAGS="-z +O2 +Onofltacc +Olit=all +Oentrysched \
+Odataprefetch +Onolimit" ;;
*-irix*)
  CC=cc CFLAGS="-Wl,-woff,84 -Wl,-woff,85 -woff 1429 \
-use_readonly_const -G0 -rdata_shared -DEBUG:optimize_space=ON \
-O2 -OPT:Olimit=0" ;;
i?86*-linux*)
  CFLAGS="-O2 -mtune=pentiumpro -march=pentiumpro" ;;
*-osf*)
  CC=cc CFLAGS="-O2 -arch ev5 -msym -readonly_strings" ;;
i?86*-solaris*)
  CC=cc CFLAGS="-mr -Qn -xstrconst -xO2 -xtarget=pentium4" ;;
*-solaris2.8)
  CC=cc CFLAGS="-mr -Qn -xstrconst -xO2 -xtarget=ultra2 \
-xarch=v8plusa" ;;
*-solaris*)
  CC=cc CFLAGS="-mr -Qn -xstrconst -xO2 -xtarget=ultra2 \
-m32 -xarch=sparcvis" ;;
esac

${SHELL} ./configure CC="${CC:-gcc}" CFLAGS="${CFLAGS:--O2}" \
LDFLAGS="${LDFLAGS+${LDFLAGS}}" --mandir="${SB_INSTALL_PREFIX}/man" \
--prefix=${SB_INSTALL_PREFIX}
]]>
    </configure>

    <install>
<![CDATA[
gmake install install.man
]]>
    </install>

    <licenses>
      <license>
        <para>Copyright (c) 1980, 1991 The Regents of the University of
California. All rights reserved.</para>
        <para>Redistribution and use in source and binary forms, with or
without modification, are permitted provided that the following
conditions are met:</para>
        <unorderedlist>
          <item><para>Redistributions of source code must retain the
above copyright notice, this list of conditions and the following
disclaimer.</para></item>
          <item><para>Redistributions in binary form must reproduce the
above copyright notice, this list of conditions and the following
disclaimer in the documentation and/or other materials provided with
the distribution.</para></item>
          <item><para>All advertising materials mentioning features or
use of this software must display the following
acknowledgement:</para>
          <indent>
            <para>This product includes software developed by the
University of California, Berkeley and its contributors.</para>
          </indent></item>
          <item><para>Neither the name of the University nor the names
of its contributors may be used to endorse or promote products derived
from this software without specific prior written
permission.</para></item>
        </unorderedlist>

        <para>THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS
"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
A PARTICULAR PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR
CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</para>
      </license>
    </licenses>

    <notes>
      <change from="6.15.02" to="6.16.00">
        <item><para>longjmp clobbered variable fixes</para></item>
        <item><para>__GNX__ addition</para></item>
        <item><para>Windows fork fixes</para></item>
      </change>

      <change from="6.15.01" to="6.15.02">
        <item><para>Fix an eval free'ing botch</para></item>
        <item><para>/bin/echo "`" coredumped because stderror() calls
longjmp corrupting the stack. We should vet the code for all
stderror() calls that cleanup local stack variables.</para></item>
        <item><para>foo &gt; ${undef} caused coredumps because of
vfork() child corrupting the state of the parent stack.</para></item>
        <item><para>$x[A-B] did not complain for A out of
range</para></item>
        <item><para>rename setp -&gt; tcsh_setp to avoid conflict with
mach</para></item>
        <item><para>Fix degree handling by defining
__XPG4_CHAR_CLASS__ for solaris</para></item>
        <item><para>Change 'od' to 'od -c' in tests so that they work
on big endian machines</para></item>
        <item><para>Add environment variable COMMAND_LINE to be
available in completions</para></item>
      </change>

      <change from="6.15.00" to="6.15.01">
        <item><para>Evaluate expressions in the proper order,
controlled by compat_expr.</para></item>
        <item><para>Don't need to flush() if we are silent. Prevents
recursive error issue.</para></item>
        <item><para>Don't execute the jobcmd if the output is not a
tty</para></item>
        <item><para>Quote the history in the examples</para></item>
        <item><para>Mismatch clarification patch</para></item>
        <item><para>Fix 'repeat n cmd &amp;' abort()</para></item>
        <item><para>Fix octal parsing</para></item>
        <item><para>Fix pty detection for autologout
setting</para></item>
        <item><para>kill `foo` got stuck because sigchld was disabled
too soon</para></item>
        <item><para>Avoid null pointer dereference in proc
cwd</para></item>
        <item><para>eval "foreach a b c" exits</para></item>
        <item><para>Quoting was broken in substitutions</para></item>
        <item><para>QNX patches via pkgsrc</para></item>
        <item><para>cd - twice from a directory that contained a glob
pattern, expands the glob twice</para></item>
        <item><para>MidnightBsd support</para></item>
        <item><para>Fix history substitution core-dump with no history
entries</para></item>
        <item><para>Merge two character tables that are the
same</para></item>
        <item><para>On ancient 7 bit locales, punctuation characters
are used to denote special characters such as umlaut, adiaresis, etc.
These characters return true for isalpha/isalnum. Ignore them because
they break parsing.</para></item>
      </change>

      <change from="6.14.07" to="6.15.00">
        <item><para>fix extension eating windows code</para></item>
        <item><para>fix loop in %R history expansion</para></item>
        <item><para>sched +X source file disables
interrupts</para></item>
        <item><para>One off copying macro buffers</para></item>
        <item><para>Avoid infinite loops in :ga modifiers when the LHS
is a substring of the RHS.</para></item>
        <item><para>Automatically disable WIDE_STRINGS with
--disable-nls</para></item>
      </change>

      <change from="6.14.06" to="6.14.07">
        <item><para>rename set to setv to avoid clashes</para></item>
        <item><para>Eliminate sighold/sigrelse</para></item>
        <item><para>Compilation cleanups</para></item>
        <item><para>Don't rebuild needlessly when generated files are
unchanged</para></item>
        <item><para>Fix confusion between Char and eChar</para></item>
      </change>

      <change from="6.14.05" to="6.14.06">
        <item><para>set PROGRAM_ENVIRONMENT for
OSD_POSIX</para></item>
        <item><para>EBCDIC patch</para></item>
        <item><para>Remove globbing support in history
rearches</para></item>
        <item><para>Highlighting patch</para></item>
        <item><para>Mark-Cursor exchange emacs editing
fix</para></item>
      </change>

      <change from="6.14.04" to="6.14.05">
        <item><para>don't limit termcap strings to 1K</para></item>
        <item><para>protect against null path.</para></item>
        <item><para>Be more conservative in wide_read
PR#29</para></item>
        <item><para>remove HAVE_STRCOLL; not needed
anymore</para></item>
        <item><para>remove imake support and make nls configurable by
configure</para></item>
      </change>

      <change from="6.14.03" to="6.14.04">
        <item><para>Fixes build failure with
!SHORT_STRINGS</para></item>
        <item><para>Fixes constness warnings with !SHORT_STRINGS:
short2str is "strip()", which modifies its argument.  Rather than
verify this is safe in all callers, I have added caching_strip() to
mirror the behavior of other modes.</para></item>
        <item><para>Fixes some constness warnings with SHORT_STRINGS;
this is orthogonal to both build errors with SHORT_STRINGS in 6.14.03,
and short_strings.patch.</para></item>
        <item><para>config-catalogs.patch: Autodetect catalog support
(#14)</para></item>
        <item><para>auth.patch: Handle false positives in getauthid()
detection, IIRC on FreeBSD</para></item>
        <item><para>crypt.patch: Autodetect whether &lt;crypt.h&gt; is
available</para></item>
        <item><para>sigint.patch: Block SIGINT while waiting on
children. This is necessary, but I'll still have to look on the older
releases to find out why it was not necessary before ("before" = 6.13
on Linux)</para></item>
        <item><para>config-package.patch: Readd package version to
configure.in, the testsuite uses it.</para></item>
        <item><para>item_len.patch: Truncate item.len when truncating
the string, just to be sure.</para></item>
        <item><para>va_list.patch: Add missing va_end()</para></item>
        <item><para>Use va_copy in xvasprintf(); emulate va_copy as
suggested in Autoconf manual if it is not available</para></item>
        <item><para>declarations.patch: Replace some #ifdef nests by
autodetecting whether the guarded declaration is necessary. I'm only
guessing this is the intent of the #ifdefs, though. Declare environ
unconditionally, it is a bit hard to detect and the declaration is
correct for Linux, anyway.</para></item>
        <item><para>warning.patch: Fix a const warning.</para></item>
        <item><para>More color-ls variables</para></item>
      </change>

      <change from="6.14.02" to="6.14.03">
        <item><para>Signal related changes</para></item>
        <item><para>Misc cast cleanups and code
clarification</para></item>
        <item><para>Use dynamically allocated buffers
everywhere</para></item>
        <item><para>Fix reading of invalid byte
sequences</para></item>
        <item><para>read should only increment count when it
succeeds</para></item>
        <item><para>testsuiteadditions</para></item>
        <item><para>-n fixes</para></item>
        <item><para>signness warnings</para></item>
        <item><para>Prevent infinite recursion in
catclose</para></item>
        <item><para>Add Dragonfly</para></item>
        <item><para>Check for wcwidth returning a negative
number</para></item>
        <item><para>recognize "li" and "co" in echotc
[PR/7]</para></item>
        <item><para>Don't use T_Cols for wrapping purposes; use TermH
consistently [PR/8]</para></item>
        <item><para>Don't display duplicate utmp records
[PR/17]</para></item>
        <item><para>Clarify hashing and -f sections of man page
[PR/20]</para></item>
        <item><para>Dave Yearke: configure did not recognize solaris
10 [PR/18]</para></item>
        <item><para>CYGWIN: Don't lowercase commands and allow foo.exe
on command line. [PR/19]</para></item>
        <item><para>CYGWIN: cd /foo &amp;&amp; cd .. ends up
erroneously in // for systems that HAVE_SLASHSLASH
[PR/21]</para></item>
        <item><para>%j was broken</para></item>
        <item><para>Extend // handling in pathnames from being apollo
specific to also cygwin</para></item>
        <item><para>Fix uppercase/lowercase
transformations</para></item>
        <item><para>Fix symlink expansion (revert from
6.10.00)</para></item>
        <item><para>Fix literal sequence in prompt</para></item>
      </change>

      <change from="6.14.01" to="6.14.02">
        <item><para>Prototype fixes</para></item>
      </change>

      <change from="6.14.00" to="6.14.01">
        <item><para>Make =- refer to $owd</para></item>
        <item><para>Use prototypes (almost) everywhere (issue
#5)</para></item>
        <item><para>Fix doc path in Cygwin installation</para></item>
        <item><para>Fix column size calculation</para></item>
        <item><para>Implement newline-and-hold and
newline-and-down-history</para></item>
        <item><para>Messages fixes for the ja (Japanese) locale (issue
#4)</para></item>
        <item><para>Enable charset conversion in nls (issue
#3)</para></item>
      </change>

      <change from="6.13.10" to="6.14.00">
        <item><para>Additional messages for the ja (Japanese)
locale</para></item>
      </change>

      <change from="6.13.09" to="6.13.10">
        <item><para>Implement --help</para></item>
        <item><para>Clamp solaris autologout time</para></item>
        <item><para>Add support for "limit heapsize"</para></item>
        <item><para>Improved autoconf for utmp/utmpx</para></item>
      </change>

      <change from="6.13.08" to="6.13.09">
        <item><para>Autoconf additions</para></item>
        <item><para>Fix erroneous sign extension when printing huge
numbers</para></item>
        <item><para>Handle delay in termcap entries</para></item>
        <item><para>EBCDIC and BS2000 fixes</para></item>
        <item><para>Avoid the SCCS percent-S-percent sequence
differently</para></item>
        <item><para>Mark position update fixes</para></item>
        <item><para>Define BSDLIMIT and BSDTIMES for
Cygwin</para></item>
        <item><para>Fix NLSFrom prototype</para></item>
      </change>

      <change from="6.13.07" to="6.13.08">
        <item><para>Add test for socklen_t in autoconf</para></item>
        <item><para>Fix problems with NLSFrom prototype</para></item>
        <item><para>Deal with AIX's utmpx lossage</para></item>
      </change>

      <change from="6.13.06" to="6.13.07">
        <item><para>constifications, XXX: duplicate prototype on
setpgrp()</para></item>
        <item><para>iconv fixes</para></item>
        <item><para>literal code cleanups</para></item>
        <item><para>move intptr_t definition to sh.h and include both
stdint.h and inttypes.h</para></item>
        <item><para>Fix dup2() issues, and introduce FSAFE as the
highest file descriptor to be left untouched. This is to avoid closing
hesiod/nis etc file descriptors behind their backs. I need to really
fix file descriptor handling one day.</para></item>
        <item><para>forward&lt;-&gt;reverse char conversion
verification</para></item>
        <item><para>japanese locale additions</para></item>
        <item><para>wide character/utf 8 cleanups</para></item>
      </change>

      <change from="6.13.05" to="6.13.06">
        <item><para>autoconf cleanup</para></item>
        <item><para>Fix literal refresh code</para></item>
        <item><para>Fix history printing bug with
WIDE_STRINGS</para></item>
      </change>

      <change from="6.13.04" to="6.13.05">
        <item><para>deal with not having intptr_t</para></item>
        <item><para>get rid of bool</para></item>
        <item><para>Protect HAVE_ICONV with NLS_CATALOGS</para></item>
        <item><para>Deal with wchar_t being unsigned</para></item>
        <item><para>If we HAVEUTMPX redefine some utmp functions in
terms of utmpx ones</para></item>
      </change>

      <change from="6.13.03" to="6.13.04">
        <item><para>Fix display problems with two-column characters
when using WIDE_STRINGS</para></item>
        <item><para>Change charset declarations for some of the
translations</para></item>
        <item><para>Set O_LARGEFILE properly</para></item>
        <item><para>Use libc functions to access utmp
data</para></item>
        <item><para>t_pmatch() was not really case-insensitive when cs
== 8</para></item>
        <item><para>Fix escaping of "control" bytes 0x80..0x9F when
they are actually parts of UTF-8 character
representation</para></item>
      </change>

      <change from="6.13.02" to="6.13.03">
        <item><para>More close_on_exec fixes</para></item>
        <item><para>SUSE dspmbyte fixes</para></item>
        <item><para>Newline handling in command substitution
controlled by csubstnonl</para></item>
        <item><para>Fix UNC prompt expansion (WIN32)</para></item>
        <item><para>Fix incorrect xprintf() usage</para></item>
        <item><para>Additional architectures support for $HOSTTYPE and
$MACHTYPE</para></item>
        <item><para>Use nl_langinfo(CODESET) to determine
$dspmbyte</para></item>
        <item><para>Complete arguments that contant a #</para></item>
        <item><para>Set close-on-exec in subshells</para></item>
        <item><para>Compilation fixes</para></item>
      </change>

      <change from="6.13.01" to="6.13.02">
        <item><para>de-register, de-extern, de-shadow, and const
poison.</para></item>
        <item><para>WIDE_STRINGS support (Miloslav
Trmac)</para></item>
        <item><para>warning cleanups (Miloslav Trmac)</para></item>
        <item><para>nlsclose() arg passing, exp2 is now a gcc builtin
(Mark Peek)</para></item>
        <item><para>iconv malloc portability fix.</para></item>
        <item><para>make automatic dspmbyte determination case
insensitive</para></item>
      </change>

      <change from="6.13.00" to="6.13.01">
        <item><para>bug fix in automatic dspmbyte
setting</para></item>
        <item><para>iconv patches</para></item>
        <item><para>cygwin signal fixes; only init 32 signals, don't
set bit flag on error; breaks SIGHUP</para></item>
        <item><para>Make sure terminal size change takes effect
immediately</para></item>
        <item><para>Obey $printexitvalue for builtins</para></item>
        <item><para>FreeBSD PR/66420: Allow history parsing to be
special so that it</para></item>
        <item><para>handle inline # characters</para></item>
        <item><para>new termname builtin from</para></item>
        <item><para>if ($var =~ *[^0-9]*) echo not numeric,
fix</para></item>
        <item><para>completion fix to avoid dup hosts from
ssh_known_hosts</para></item>
        <item><para>vc++ 7.1 compilation fix</para></item>
        <item><para>UTF-8 handling for both single and double width
characters, but no combining character support</para></item>
      </change>

      <change from="6.12.02" to="6.13.03">
        <item><para>turn on kanji and dspmbyte by default; add check
for utf8 locales, and turn parsing of that automatically based on
$LANG</para></item>
        <item><para>Fix compilation issue under Windows/NT and charset
incorrect patch</para></item>
        <item><para>completion additions</para></item>
        <item><para>compilation fix</para></item>
      </change>

      <change from="6.12.01" to="6.13.02">
        <item><para>Glob completion listing addition</para></item>
        <item><para>BS2000 bs2cmd builtin</para></item>
        <item><para>Fix interrupt resetting code when /etc startup
scripts have syntax errors</para></item>
        <item><para>Clarification of kill-ring commands</para></item>
        <item><para>Debian completion additions</para></item>
        <item><para>Japanese character set fixes from
debian</para></item>
        <item><para>NLS charset fixes; disabled since they only work
with gnu gencat</para></item>
        <item><para>Fix HPUX &gt;= 11 resource</para></item>
        <item><para>Handle breaksw that jumps out of
loops</para></item>
        <item><para>Revert #16. It causes worse
problems.</para></item>
        <item><para>Avoid using execl() because the last NULL does not
always promoted to a pointer because the function is
variadic</para></item>
        <item><para>revert ignoreeof to the 6.11.00 behavior and
document it</para></item>
        <item><para>do a case insensitive comparison for the multibyte
vars</para></item>
        <item><para>don't sigsuspend() for an already exited
job</para></item>
        <item><para>glob all arguments in source</para></item>
        <item><para>various debian fixes</para></item>
        <item><para>setenv syntax check revert</para></item>
        <item><para>EAGAIN typo</para></item>
        <item><para>filec compilation issue on hpux</para></item>
        <item><para>win32 compilation fixes for
O_LARGEFILE</para></item>
        <item><para>Don't go into an infinite loop when tcgetpgrp()
returns an error</para></item>
        <item><para>Cygwin fixes</para></item>
        <item><para>NLS catclose() bug avoidance</para></item>
      </change>

      <change from="6.12.00" to="6.13.01">
        <item><para>Misc NT cleanup. No more GPL code</para></item>
        <item><para>use strtol() to detect errors in builtin
kill</para></item>
        <item><para>Recognize linux systems on mips*</para></item>
        <item><para>Enable complete=igncase on unix</para></item>
        <item><para>Eliminate maxitems</para></item>
      </change>
    </notes>

    <changelog>
      <change date="2012 January 18" revision="4"
      author="Albert Chin-A-Young" email="china@thewrittenword.com">
        <item><para>Update bison dependency from 2.3 to
2.4.3</para></item>
      </change>

      <change date="2010 November 19" revision="3"
      author="Albert Chin-A-Young" email="china@thewrittenword.com">
        <item><para>Add support for AIX 7.1</para></item>
      </change>

      <change date="2010 November 9" revision="2"
      author="Albert Chin-A-Young" email="china@thewrittenword.com">
        <item><para>Add support for RHEL 6</para></item>
      </change>
    </changelog>
  </program>
</programs>

<?xml version="1.0"?>
<programs>
<!DOCTYPE programs SYSTEM "sb-db.dtd">
  <program name="nagios-server" version="3.0.3" revision="3"
  systype="*-aix*|*-hpux11*|*-irix*|*-linux*|*-solaris*">
    <build-name>nagios-${SB_PROG_VER}</build-name>

    <install-name>nagiosserver30</install-name>

    <sources>
      <source checksum="151df7bf19b696f7498410fb76fb7caf"
        checksum-type="md5" size="2759396"
        path="src/nagios-3.0.3.tar.gz"/>
      <patch checksum="87bb97401b2d0504d14465066066b67c"
        checksum-type="md5" size="26329"
        path="src/nagios-3.0.3.tww.patch"/>
      <patch checksum="76df487570c4d338f0a5ef29a99ebc4e"
        checksum-type="md5" size="1582504"
        path="src/nagios-3.0.3.ltdl.patch"/>
      <patch checksum="d223d8feb909e7ba6e38f56cfad58a84"
        checksum-type="md5" size="418"
        path="src/nagios-3.0.3.tww-ltdl.patch"/>
      <patch checksum="ca4e1d03b1c8a5e5226f6dcf2e4da058"
        checksum-type="md5" size="2126190"
        path="src/nagios-3.0.3.auto.patch"/>
    </sources>

    <dependencies>
      <depend user="nagios"/>

      <depend group="nagios"/>

      <depend group="nagcmd"/>

    </dependencies>

    <script-header>
<![CDATA[
_datadir=${SB_INSTALL_PREFIX}/share
_docdir=${SB_INSTALL_PREFIX}/doc
_sysconfdir="/etc${SB_INSTALL_PREFIX}"
_localstatedir="/var${SB_INSTALL_PREFIX}"

case "${SB_SYSTYPE}" in
*-aix*)
  CC=xlc CFLAGS="-O2 -qro -qroconst -qmaxmem=-1 -qarch=ppc"
  LDFLAGS="-Wl,-brtl -Wl,-blibpath:/usr/lib"
  CC_LD_RT="-Wl,-blibpath:" ;;
ia64*-hpux*)
  CC=cc CFLAGS="-z +O2 +Ofltacc +Olit=all +Oentrysched \
+Odataprefetch +Onolimit"
  CC_LD_RT="-Wl,+b," ;;
*-hpux11.[01]*)
  CC=cc CFLAGS="-z +O2 +Ofltacc +Olit=all +DAportable \
+Oentrysched +Odataprefetch +Onolimit"
  CC_LD_RT="-Wl,+s,+b," ;;
*-hpux*)
  CC=cc CFLAGS="-z +O2 +Ofltacc +Olit=all +Oentrysched \
+Odataprefetch +Onolimit"
  CC_LD_RT="-Wl,+s,+b," ;;
*-irix*)
  CC=cc CFLAGS="-Wl,-woff,84 -Wl,-woff,85 -woff 1009,1429 \
-use_readonly_const -G0 -rdata_shared -DEBUG:optimize_space=ON \
-O2 -OPT:Olimit=0"
  CC_LD_RT="-Wl,-rpath," ;;
i?86*-linuxe3)
  CFLAGS="-O2 -mcpu=pentiumpro -march=pentiumpro"
  CC_LD_RT="-Wl,-rpath," ;;
i?86*-linux*)
  CFLAGS="-O2 -mtune=pentiumpro -march=pentiumpro"
  CC_LD_RT="-Wl,-rpath," ;;
*-linux*)
  CC_LD_RT="-Wl,-rpath," ;;
*-osf*)
  CC=cc CFLAGS="-O2 -arch ev5 -msym -readonly_strings"
  CC_LD_RT="-Wl,-rpath," ;;
i?86*-solaris*)
  CC=cc CFLAGS="-mr -Qn -xstrconst -xO2 -xtarget=pentium4"
  CC_LD_RT="-R" ;;
*-solaris2.[678])
  CC=cc CFLAGS="-mr -Qn -xstrconst -xO2 -xtarget=ultra2 \
-xarch=v8plusa"
  CC_LD_RT="-R" ;;
*-solaris*)
  CC=cc CFLAGS="-mr -Qn -xstrconst -xO2 -xtarget=ultra2 \
-m32 -xarch=sparcvis"
  CC_LD_RT="-R" ;;
esac
]]>
    </script-header>

    <module name="default">
      <dependencies replace="0">
        <depend program="fcpackage" var="FCPACKAGE"
          install-name="fcpackage28">v&gt;=2.8</depend>
        <depend program="freetype" var="LIBTTF"
          install-name="libttf24">v&gt;=2.4.6</depend>
        <depend program="gettext" var="GETTEXT"
          install-name="gettext018">v&gt;=0.18.1.1</depend>
        <depend program="libiconv" var="libiconv"
          install-name="libiconv113">v&gt;=1.13.1</depend>
        <depend program="glib" var="LIBGLIB" install-name="libglib226"
          add-path="prepend">v&gt;=2.26.1</depend>
        <depend program="gd" var="LIBGD" install-name="libgd20"
          add-path="prepend">v&gt;=2.0.35</depend>
        <depend program="jpeg" var="JPEG"
          install-name="libjpeg8">v&gt;=8b</depend>
        <depend program="libpng" var="LIBPNG"
          install-name="libpng14">v&gt;=1.4.4</depend>
        <depend program="perl" var="PERL"
          add-path="prepend">v==5.12.2</depend>
        <depend program="pkgconfig" install-name="pkgconfig02"
          add-path="prepend" type="build">v&gt;=0.25</depend>
        <depend program="xpm" var="XPM"
          install-name="xpm">v&gt;=3.4k</depend>
        <depend program="zlib" var="LIBZ"
          install-name="libz12">v&gt;=1.2.5</depend>
      </dependencies>

      <validate>
        <depend program="nagios-server"
          module="plugins">v==3.0.3</depend>
        <depend program="nagios-server"
          module="ndoutils">v==3.0.3</depend>
        <depend program="nagios-server" module="nsca">v==3.0.3</depend>
        <depend program="nagios-server" module="nrpe">v==3.0.3</depend>
      </validate>

      <script-header>
<![CDATA[
_datadir=${SB_INSTALL_PREFIX}/share
_docdir=${SB_INSTALL_PREFIX}/doc
_sysconfdir="/etc${SB_INSTALL_PREFIX}"
_localstatedir="/var${SB_INSTALL_PREFIX}"

case "${SB_SYSTYPE}" in
*-aix*)
  CC=xlc CFLAGS="-O2 -qro -qroconst -qmaxmem=-1 -qarch=ppc"
  LDFLAGS="-Wl,-brtl -Wl,-blibpath:/usr/lib"
  CC_LD_RT="-Wl,-blibpath:" ;;
ia64*-hpux*)
  CC=cc CFLAGS="-z +O2 +Ofltacc +Olit=all +Oentrysched \
+Odataprefetch +Onolimit"
  CC_LD_RT="-Wl,+b," ;;
*-hpux11.[01]*)
  CC=cc CFLAGS="-z +O2 +Ofltacc +Olit=all +DAportable \
+Oentrysched +Odataprefetch +Onolimit"
  CC_LD_RT="-Wl,+s,+b," ;;
*-hpux*)
  CC=cc CFLAGS="-z +O2 +Ofltacc +Olit=all +Oentrysched \
+Odataprefetch +Onolimit"
  CC_LD_RT="-Wl,+s,+b," ;;
*-irix*)
  CC=cc CFLAGS="-Wl,-woff,84 -Wl,-woff,85 -woff 1009,1429 \
-use_readonly_const -G0 -rdata_shared -DEBUG:optimize_space=ON \
-O2 -OPT:Olimit=0"
  CC_LD_RT="-Wl,-rpath," ;;
i?86*-linuxe3)
  CFLAGS="-O2 -mcpu=pentiumpro -march=pentiumpro"
  CC_LD_RT="-Wl,-rpath," ;;
i?86*-linux*)
  CFLAGS="-O2 -mtune=pentiumpro -march=pentiumpro"
  CC_LD_RT="-Wl,-rpath," ;;
*-linux*)
  CC_LD_RT="-Wl,-rpath," ;;
*-osf*)
  CC=cc CFLAGS="-O2 -arch ev5 -msym -readonly_strings"
  CC_LD_RT="-Wl,-rpath," ;;
i?86*-solaris*)
  CC=cc CFLAGS="-mr -Qn -xstrconst -xO2 -xtarget=pentium4"
  CC_LD_RT="-R" ;;
*-solaris2.[678])
  CC=cc CFLAGS="-mr -Qn -xstrconst -xO2 -xtarget=ultra2 \
-xarch=v8plusa"
  CC_LD_RT="-R" ;;
*-solaris*)
  CC=cc CFLAGS="-mr -Qn -xstrconst -xO2 -xtarget=ultra2 \
-m32 -xarch=sparcvis"
  CC_LD_RT="-R" ;;
esac
]]>
      </script-header>

      <configure>
<![CDATA[
${SHELL} ./configure CC="${CC-gcc}" CFLAGS="${CFLAGS--O2}" \
CPPFLAGS="-I${SB_VAR_LIBGD_INC} ${CPPFLAGS+${CPPFLAGS}}" \
LDFLAGS="-L${SB_VAR_LIBGD_LIB} \
${SB_VAR_JPEG+-L${SB_VAR_JPEG_LIB}} \
${SB_VAR_LIBPNG+-L${SB_VAR_LIBPNG_LIB}} \
${SB_VAR_LIBZ+-L${SB_VAR_LIBZ_LIB}} \
${SB_VAR_LIBTTF+-L${SB_VAR_LIBTTF_LIB}} \
${SB_VAR_FCPACKAGE+-L${SB_VAR_FCPACKAGE_LIB}} \
${SB_VAR_XPM+-L${SB_VAR_XPM_LIB}} \
${CC_LD_RT}${SB_VAR_LIBGD_LIB}\
${SB_VAR_JPEG+:${SB_VAR_JPEG_LIB}}\
${SB_VAR_LIBPNG+:${SB_VAR_LIBPNG_LIB}}\
${SB_VAR_LIBZ+:${SB_VAR_LIBZ_LIB}}\
${SB_VAR_LIBTTF+:${SB_VAR_LIBTTF_LIB}}\
${SB_VAR_FCPACKAGE+:${SB_VAR_FCPACKAGE_LIB}}\
${SB_VAR_XPM+:${SB_VAR_XPM_LIB}} \
${LDFLAGS+${LDFLAGS}}" \
PKG_CONFIG_PATH="${SB_VAR_LIBGLIB+${SB_VAR_LIBGLIB_LIB}/pkgconfig}\
${SB_VAR_GETTEXT+:${SB_VAR_GETTEXT_LIB}/pkgconfig}\
${SB_VAR_LIBICONV+:${SB_VAR_LIBICONV_LIB}/pkgconfig}" \
--with-nagios-user=nagios --with-nagios-group=nagios \
--with-command-group="nagcmd" \
--sysconfdir=${_sysconfdir} --localstatedir=${_localstatedir} \
--with-httpd-conf="${_sysconfdir}/httpd.conf.d" \
--with-checkresult-dir=${_localstatedir} \
--with-init-dir="${_sysconfdir}/rc" \
--with-lockfile="${_localstatedir}/run/nagios.pid" \
--mandir="${SB_INSTALL_PREFIX}/man" \
--infodir="${SB_INSTALL_PREFIX}/info" \
--datadir=${_datadir} --prefix=${SB_INSTALL_PREFIX}

gmake configure
]]>
      </configure>

      <build>
<![CDATA[
gmake all
]]>
      </build>

      <install>
<![CDATA[
${SB_PATH_INSTALL} -d -m 755 -o nagios -g nagios ${_sysconfdir} \
${_localstatedir} ${_localstatedir}/run ${SB_INSTALL_PREFIX}/include \
${_docdir} ${_docdir}/html

gmake install install-config HTMLDIR="${_docdir}/html"

(cd ${_sysconfdir}
 for _file in cgi.cfg nagios.cfg resource.cfg; do
   mv $_file ${_file}-sample
   ${SB_PATH_INSTALL} -m 644 -o nagios -g nagios /dev/null ${_file}
 done)

(cd ${_sysconfdir}/objects
 for _file in commands.cfg contacts.cfg localhost.cfg printer.cfg \
   switch.cfg templates.cfg timeperiods.cfg windows.cfg; do
   mv $_file ${_file}-sample 
 done)

gmake install-commandmode

(cd sample-config
 ${SB_PATH_INSTALL} -m 644 -o nagios -g nagios httpd.conf \
 ${_sysconfdir}/httpd.conf-sample)

(cd include
 ${SB_PATH_INSTALL} -o nagios -g nagios locations.h \
 ${SB_INSTALL_PREFIX}/include)
]]>
      </install>

      <uninstall>
<![CDATA[
rm -rf ${SB_INSTALL_PREFIX} ${_sysconfdir} ${_localstatedir}
]]>
      </uninstall>
    </module>

    <module name="nrpe">
      <build-name>nrpe-2.12</build-name>

      <sources>
        <source checksum="b2d75e2962f1e3151ef58794d60c9e97"
          checksum-type="md5" size="405725"
          path="src/nrpe-2.12.tar.gz"/>
        <patch checksum="095971dfb1ad6c3fac01acdc3f700941"
          checksum-type="md5" size="6211"
          path="src/nrpe-2.12.tww.patch"/>
        <patch checksum="8bfeef6a4ce0a3cf59b44cc55c1de447"
          checksum-type="md5" size="397102"
          path="src/nrpe-2.12.auto.patch"/>
      </sources>

      <dependencies replace="0">
        <depend program="openssl" var="LIBOPENSSL"
          install-name="libopenssl10">v&gt;=1.0.0e</depend>
        <depend program="perl" var="PERL"
          add-path="prepend">v==5.12.2</depend>
        <depend program="tcp_wrappers" var="LIBWRAP">v==7.6</depend>
      </dependencies>

      <script-header>
<![CDATA[
_datadir=${SB_INSTALL_PREFIX}/share
_docdir=${SB_INSTALL_PREFIX}/doc
_sysconfdir="/etc${SB_INSTALL_PREFIX}"
_localstatedir="/var${SB_INSTALL_PREFIX}"

case "${SB_SYSTYPE}" in
*-aix*)
  CC=xlc CFLAGS="-O2 -qro -qroconst -qmaxmem=-1 -qarch=ppc"
  LDFLAGS="-Wl,-brtl -Wl,-blibpath:/usr/lib"
  CC_LD_RT="-Wl,-blibpath:" ;;
ia64*-hpux*)
  CC=cc CFLAGS="-z +O2 +Ofltacc +Olit=all +Oentrysched \
+Odataprefetch +Onolimit"
  CC_LD_RT="-Wl,+b," ;;
*-hpux11.[01]*)
  CC=cc CFLAGS="-z +O2 +Ofltacc +Olit=all +DAportable \
+Oentrysched +Odataprefetch +Onolimit"
  CC_LD_RT="-Wl,+s,+b," ;;
*-hpux*)
  CC=cc CFLAGS="-z +O2 +Ofltacc +Olit=all +Oentrysched \
+Odataprefetch +Onolimit"
  CC_LD_RT="-Wl,+s,+b," ;;
*-irix*)
  CC=cc CFLAGS="-Wl,-woff,84 -Wl,-woff,85 -woff 1009,1429 \
-use_readonly_const -G0 -rdata_shared -DEBUG:optimize_space=ON \
-O2 -OPT:Olimit=0"
  CC_LD_RT="-Wl,-rpath," ;;
i?86*-linuxe3)
  CFLAGS="-O2 -mcpu=pentiumpro -march=pentiumpro"
  CC_LD_RT="-Wl,-rpath," ;;
i?86*-linux*)
  CFLAGS="-O2 -mtune=pentiumpro -march=pentiumpro"
  CC_LD_RT="-Wl,-rpath," ;;
*-linux*)
  CC_LD_RT="-Wl,-rpath," ;;
*-osf*)
  CC=cc CFLAGS="-O2 -arch ev5 -msym -readonly_strings"
  CC_LD_RT="-Wl,-rpath," ;;
i?86*-solaris*)
  CC=cc CFLAGS="-mr -Qn -xstrconst -xO2 -xtarget=pentium4"
  CC_LD_RT="-R" ;;
*-solaris2.[678])
  CC=cc CFLAGS="-mr -Qn -xstrconst -xO2 -xtarget=ultra2 \
-xarch=v8plusa"
  CC_LD_RT="-R" ;;
*-solaris*)
  CC=cc CFLAGS="-mr -Qn -xstrconst -xO2 -xtarget=ultra2 \
-m32 -xarch=sparcvis"
  CC_LD_RT="-R" ;;
esac
]]>
      </script-header>

      <configure>
<![CDATA[
${SHELL} ./configure CC="${CC-gcc}" CFLAGS="${CFLAGS--O2}" \
CPPFLAGS="-I${SB_VAR_LIBWRAP_INC} ${CPPFLAGS+${CPPFLAGS}}" \
LDFLAGS="-L${SB_VAR_LIBWRAP_LIB} ${CC_LD_RT}${SB_VAR_LIBOPENSSL_LIB} \
${LDFLAGS+${LDFLAGS}}" \
--with-nrpe-user=nagios --with-nrpe-group=nagios \
--with-nagios-user=nagios --with-nagios-group=nagios \
--sysconfdir=${_sysconfdir} --localstatedir=${_localstatedir} \
--with-ssl=${SB_VAR_LIBOPENSSL} \
--prefix=${SB_INSTALL_PREFIX}
]]>
      </configure>

      <install>
<![CDATA[
${SB_PATH_INSTALL} -d -m 755 -o nagios -g nagios ${_sysconfdir}

gmake install

(cd sample-config
 ${SB_PATH_INSTALL} -o nagios -g nagios -m 644 nrpe.cfg \
 ${_sysconfdir}/nrpe.cfg-sample 
 ${SB_PATH_INSTALL} -o nagios -g nagios -m 644 nrpe.xinetd \
 ${_sysconfdir}/nrpe.xinetd-sample)

${SB_PATH_INSTALL} -m 755 -o root -g 0 -d ${_docdir}
${SB_PATH_INSTALL} -m 644 docs/NRPE.pdf ${_docdir}
]]>
      </install>

      <uninstall>
<![CDATA[
rm -f ${_sysconfdir}/nrpe.xinetd-sample ${_docdir}/NRPE.pdf \
${_sysconfdir}/nrpe.cfg-sample ${SB_INSTALL_PREFIX}/bin/nrpe \
${SB_INSTALL_PREFIX}/libexec/check_nrpe
]]>
      </uninstall>
    </module>

    <module name="ndoutils">
      <build-name>ndoutils-1.4b7</build-name>

      <sources>
        <source checksum="a454f7434f401bd48047cc42b045ff8b"
          checksum-type="md5" size="1553879"
          path="src/ndoutils-1.4b7.tar.gz"/>
        <patch checksum="e5c7d0820de1fbe66792a4def24412d0"
          checksum-type="md5" size="22241"
          path="src/ndoutils-1.4b7.tww.patch"/>
        <patch checksum="88d02be9968badf98322bd74366227a7"
          checksum-type="md5" size="304820"
          path="src/ndoutils-1.4b7.gnulib.patch"/>
        <patch checksum="a4b31c467c7f9d08d1a00373ee90b8eb"
          checksum-type="md5" size="7686"
          path="src/ndoutils-1.4b7.tww-gnulib.patch"/>
        <patch checksum="7aa5fca40328e979d98811d5ddd65b16"
          checksum-type="md5" size="1225088"
          path="src/ndoutils-1.4b7.auto.patch"/>
      </sources>

      <dependencies replace="0">
        <depend program="nagios-server">v==3.0.3</depend>
        <depend program="mysql" var="MYSQL" module="libruntime"
          add-path="prepend">v==5.5.15</depend>
        <depend program="perl" var="PERL"
          add-path="prepend">v==5.12.2</depend>
      </dependencies>

      <script-header>
<![CDATA[
_datadir=${SB_INSTALL_PREFIX}/share
_docdir=${SB_INSTALL_PREFIX}/doc
_sysconfdir="/etc${SB_INSTALL_PREFIX}"
_localstatedir="/var${SB_INSTALL_PREFIX}"

case "${SB_SYSTYPE}" in
*-aix*)
  CC=xlc CFLAGS="-O2 -qro -qroconst -qmaxmem=-1 -qarch=ppc"
  LDFLAGS="-Wl,-brtl -Wl,-blibpath:/usr/lib"
  CC_LD_RT="-Wl,-blibpath:" ;;
ia64*-hpux*)
  CC=cc CFLAGS="-z +O2 +Ofltacc +Olit=all +Oentrysched \
+Odataprefetch +Onolimit"
  CC_LD_RT="-Wl,+b," ;;
*-hpux11.[01]*)
  CC=cc CFLAGS="-z +O2 +Ofltacc +Olit=all +DAportable \
+Oentrysched +Odataprefetch +Onolimit"
  CC_LD_RT="-Wl,+s,+b," ;;
*-hpux*)
  CC=cc CFLAGS="-z +O2 +Ofltacc +Olit=all +Oentrysched \
+Odataprefetch +Onolimit"
  CC_LD_RT="-Wl,+s,+b," ;;
*-irix*)
  CC=cc CFLAGS="-Wl,-woff,84 -Wl,-woff,85 -woff 1009,1429 \
-use_readonly_const -G0 -rdata_shared -DEBUG:optimize_space=ON \
-O2 -OPT:Olimit=0"
  CC_LD_RT="-Wl,-rpath," ;;
i?86*-linuxe3)
  CFLAGS="-O2 -mcpu=pentiumpro -march=pentiumpro"
  CC_LD_RT="-Wl,-rpath," ;;
i?86*-linux*)
  CFLAGS="-O2 -mtune=pentiumpro -march=pentiumpro"
  CC_LD_RT="-Wl,-rpath," ;;
*-linux*)
  CC_LD_RT="-Wl,-rpath," ;;
*-osf*)
  CC=cc CFLAGS="-O2 -arch ev5 -msym -readonly_strings"
  CC_LD_RT="-Wl,-rpath," ;;
i?86*-solaris*)
  CC=cc CFLAGS="-mr -Qn -xstrconst -xO2 -xtarget=pentium4"
  CC_LD_RT="-R" ;;
*-solaris2.[678])
  CC=cc CFLAGS="-mr -Qn -xstrconst -xO2 -xtarget=ultra2 \
-xarch=v8plusa"
  CC_LD_RT="-R" ;;
*-solaris*)
  CC=cc CFLAGS="-mr -Qn -xstrconst -xO2 -xtarget=ultra2 \
-m32 -xarch=sparcvis"
  CC_LD_RT="-R" ;;
esac
]]>
      </script-header>

      <configure>
<![CDATA[
${SHELL} ./configure CC="${CC-gcc}" CFLAGS="${CFLAGS--O2}" \
CPPFLAGS="-I${SB_INSTALL_PREFIX}/include \
-I${SB_VAR_MYSQL_INC} ${CPPFLAGS+${CPPFLAGS}}" \
LDFLAGS="${CC_LD_RT}${SB_VAR_MYSQL_LIB} ${LDFLAGS+${LDFLAGS}}" \
--with-ndo2db-user=nagios --with-ndo2db-group=nagios \
--enable-mysql --disable-pgsql --disable-static \
--with-mysql-lib=${SB_VAR_MYSQL_LIB} \
--with-mysql-inc=${SB_VAR_MYSQL_INC} \
--sysconfdir=${_sysconfdir} --localstatedir=${_localstatedir} \
--prefix=${SB_INSTALL_PREFIX}
]]>
      </configure>

      <build>
<![CDATA[
gmake all
]]>
      </build>

      <install>
<![CDATA[
${SB_PATH_INSTALL} -d -m 755 -o nagios -g nagios \
${SB_INSTALL_PREFIX}/lib

# Install the loadable module
./libtool --mode=install ${SB_PATH_INSTALL} -m 755 ./src/ndomod-3x.la \
${SB_INSTALL_PREFIX}/lib

# Install the daemon
./libtool --mode=install ${SB_PATH_INSTALL} -m 755 ./src/ndo2db-3x \
${SB_INSTALL_PREFIX}/bin/ndo2db

(cd config
 ${SB_PATH_INSTALL} -m 644 -o nagios -g nagios ndo2db.cfg \
 ${_sysconfdir}/ndo2db.cfg-sample
 
 ${SB_PATH_INSTALL} -m 644 -o nagios -g nagios ndomod.cfg \
 ${_sysconfdir}/ndomod.cfg-sample)

(cd docs
 ${SB_PATH_INSTALL} -m 644 'NDOUTILS DB Model.pdf' \
 ${_docdir}/NDOUTILS-DB-Model.pdf
 ${SB_PATH_INSTALL} -m 644 'NDOUtils Documentation.pdf' \
 ${_docdir}/NDOUTILS-Documentation.pdf)

(cd db
 ${SB_PATH_INSTALL} -m 755 -d ${_docdir}/ndoutils \
 ${_docdir}/ndoutils/queries
 ${SB_PATH_INSTALL} -m 644 README mysql.sql installdb \
 ${_docdir}/ndoutils
 cd queries
 ${SB_PATH_INSTALL} -m 644 * ${_docdir}/ndoutils/queries)
]]>
      </install>

      <uninstall>
<![CDATA[
rm -f ${SB_INSTALL_PREFIX}/bin/ndo2db \
${_sysconfdir}/ndo2db.cfg-sample \
${_sysconfdir}/ndomod.cfg-sample \
${_docdir}/NDOUTILS_DB_Model.pdf \
${_docdir}/NDOUTILS_Documentation.pdf \
${SB_INSTALL_PREFIX}/lib/ndomod-3x.*

rmdir ${SB_INSTALL_PREFIX}/lib || :
]]>
      </uninstall>
    </module>

    <module name="nsca">
      <build-name>nsca-2.7.2</build-name>

      <sources>
        <source checksum="33a98e7975f633a9489d7a8938ed6131"
          checksum-type="md5" size="104953"
          path="src/nsca-2.7.2.tar.gz"/>
        <patch checksum="2a6f5daf028f50eb97e03071fdb4b847"
          checksum-type="md5" size="1533"
          path="src/nsca-2.7.2.tww.patch"/>
        <patch checksum="31a7b5b8492b7bcea0df72d3466b46ea"
          checksum-type="md5" size="370539"
          path="src/nsca-2.7.2.auto.patch"/>
      </sources>

      <dependencies replace="0">
        <depend program="libmcrypt" var="LIBMCRYPT"
          install-name="libmcrypt25">v&gt;=2.5.8</depend>
        <depend program="perl" var="PERL"
          add-path="prepend">v==5.12.2</depend>
        <depend program="tcp_wrappers" var="LIBWRAP">v==7.6</depend>
      </dependencies>

      <script-header>
<![CDATA[
_datadir=${SB_INSTALL_PREFIX}/share
_docdir=${SB_INSTALL_PREFIX}/doc
_sysconfdir="/etc${SB_INSTALL_PREFIX}"
_localstatedir="/var${SB_INSTALL_PREFIX}"

case "${SB_SYSTYPE}" in
*-aix*)
  CC=xlc CFLAGS="-O2 -qro -qroconst -qmaxmem=-1 -qarch=ppc"
  LDFLAGS="-Wl,-brtl -Wl,-blibpath:/usr/lib"
  CC_LD_RT="-Wl,-blibpath:" ;;
ia64*-hpux*)
  CC=cc CFLAGS="-z +O2 +Ofltacc +Olit=all +Oentrysched \
+Odataprefetch +Onolimit"
  CC_LD_RT="-Wl,+b," ;;
*-hpux11.[01]*)
  CC=cc CFLAGS="-z +O2 +Ofltacc +Olit=all +DAportable \
+Oentrysched +Odataprefetch +Onolimit"
  CC_LD_RT="-Wl,+s,+b," ;;
*-hpux*)
  CC=cc CFLAGS="-z +O2 +Ofltacc +Olit=all +Oentrysched \
+Odataprefetch +Onolimit"
  CC_LD_RT="-Wl,+s,+b," ;;
*-irix*)
  CC=cc CFLAGS="-Wl,-woff,84 -Wl,-woff,85 -woff 1009,1429 \
-use_readonly_const -G0 -rdata_shared -DEBUG:optimize_space=ON \
-O2 -OPT:Olimit=0"
  CC_LD_RT="-Wl,-rpath," ;;
i?86*-linuxe3)
  CFLAGS="-O2 -mcpu=pentiumpro -march=pentiumpro"
  CC_LD_RT="-Wl,-rpath," ;;
i?86*-linux*)
  CFLAGS="-O2 -mtune=pentiumpro -march=pentiumpro"
  CC_LD_RT="-Wl,-rpath," ;;
*-linux*)
  CC_LD_RT="-Wl,-rpath," ;;
*-osf*)
  CC=cc CFLAGS="-O2 -arch ev5 -msym -readonly_strings"
  CC_LD_RT="-Wl,-rpath," ;;
i?86*-solaris*)
  CC=cc CFLAGS="-mr -Qn -xstrconst -xO2 -xtarget=pentium4"
  CC_LD_RT="-R" ;;
*-solaris2.[678])
  CC=cc CFLAGS="-mr -Qn -xstrconst -xO2 -xtarget=ultra2 \
-xarch=v8plusa"
  CC_LD_RT="-R" ;;
*-solaris*)
  CC=cc CFLAGS="-mr -Qn -xstrconst -xO2 -xtarget=ultra2 \
-m32 -xarch=sparcvis"
  CC_LD_RT="-R" ;;
esac
]]>
      </script-header>

      <configure>
<![CDATA[
${SHELL} ./configure CC="${CC-gcc}" CFLAGS="${CFLAGS--O2}" \
CPPFLAGS="-I${SB_VAR_LIBWRAP_INC} ${CPPFLAGS+${CPPFLAGS}}" \
LDFLAGS="-L${SB_VAR_LIBWRAP_LIB} \
${LDFLAGS+${LDFLAGS}}" \
--with-libmcrypt-prefix=${SB_VAR_LIBMCRYPT} \
--with-nsca-user=nagios --with-nsca-grp=nagios \
--sysconfdir=${_sysconfdir} --localstatedir=${_localstatedir} \
--prefix=${SB_INSTALL_PREFIX}
]]>
      </configure>

      <install>
<![CDATA[
${SB_PATH_INSTALL} -d -m 755 -o nagios -g nagios \
${SB_INSTALL_PREFIX}/bin ${_sysconfdir}
${SB_PATH_INSTALL} -o nagios -g nagios src/nsca \
${SB_INSTALL_PREFIX}/bin/nsca 
${SB_PATH_INSTALL} -o nagios -g nagios src/send_nsca \
${SB_INSTALL_PREFIX}/bin/send_nsca 

(cd sample-config
 ${SB_PATH_INSTALL} -o nagios -g nagios -m 644 nsca.cfg \
 ${_sysconfdir}/nsca.cfg-sample 
 ${SB_PATH_INSTALL} -o nagios -g nagios -m 644 send_nsca.cfg \
 ${_sysconfdir}/send_nsca.cfg-sample 
 ${SB_PATH_INSTALL} -o nagios -g nagios -m 644 nsca.xinetd \
 ${_sysconfdir}/nsca.xinetd-sample)
]]>
      </install>

      <uninstall>
<![CDATA[
rm -f ${_sysconfdir}/nsca.xinetd-sample \
${_sysconfdir}/nsca.cfg-sample \
${_sysconfdir}/send_nsca.cfg-sample \
${SB_INSTALL_PREFIX}/bin/nsca \
${SB_INSTALL_PREFIX}/bin/send_ncsa
]]>
      </uninstall>
    </module>

    <module name="plugins">
      <build-name>nagios-plugins-1.4.12</build-name>

      <sources>
        <source checksum="af68d00bbe2c39de02803d23e5eecca3"
          checksum-type="md5" size="1831377"
          path="src/nagios-plugins-1.4.12.tar.gz"/>
        <patch checksum="1acd55864008ec5278464eba503ce6b6"
          checksum-type="md5" size="32252"
          path="src/nagios-plugins-1.4.12.tww.patch"/>
        <patch checksum="88561718cbf58a5643e636ae34159671"
          checksum-type="md5" size="212272"
          path="src/nagios-plugins-1.4.12.gnulib.patch"/>
        <patch checksum="33bf4ae519f1202ac588a9592e3c8d4c"
          checksum-type="md5" size="3054022"
          path="src/nagios-plugins-1.4.12.auto.patch"/>
      </sources>

      <dependencies replace="0">
        <depend program="fping" var="FPING">v==2.4</depend>
        <depend program="gettext" var="GETTEXT"
          install-name="gettext018">v&gt;=0.18.1.1</depend>
        <depend program="libiconv" var="libiconv"
          install-name="libiconv113">v&gt;=1.13.1</depend>
        <depend program="glib" var="LIBGLIB"
          install-name="libglib226">v&gt;=2.26.1</depend>
        <depend program="mysql" var="MYSQL" module="libruntime"
          add-path="prepend">v==5.5.15</depend>
        <depend program="net-snmp" add-path="prepend">v==5.7.1</depend>
        <depend program="openldap" var="OPENLDAP">v==2.4.26</depend>
        <depend program="openssh" add-path="prepend">v==5.9</depend>
        <depend program="openssl" var="LIBOPENSSL"
          install-name="libopenssl10">v&gt;=1.0.0e</depend>
        <depend program="perl" var="PERL"
          add-path="prepend">v==5.12.2</depend>
        <depend program="postfix" add-path="prepend">v==2.8.4</depend>
        <depend program="postgresql" var="PGSQL" module="libruntime"
          add-path="prepend">v==9.0.6</depend>
        <depend program="python" add-path="prepend">v==2.6.7</depend>
        <depend program="samba" add-path="prepend">v==3.6.1</depend>
        <depend program="zlib" var="LIBZ"
          install-name="libz12">v&gt;=1.2.5</depend>
      </dependencies>

      <script-header>
<![CDATA[
_datadir=${SB_INSTALL_PREFIX}/share
_docdir=${SB_INSTALL_PREFIX}/doc
_sysconfdir="/etc${SB_INSTALL_PREFIX}"
_localstatedir="/var${SB_INSTALL_PREFIX}"

case "${SB_SYSTYPE}" in
*-aix*)
  CC=xlc CFLAGS="-O2 -qro -qroconst -qmaxmem=-1 -qarch=ppc"
  LDFLAGS="-Wl,-brtl -Wl,-blibpath:/usr/lib"
  CC_LD_RT="-Wl,-blibpath:" ;;
ia64*-hpux*)
  CC=cc CFLAGS="-z +O2 +Ofltacc +Olit=all +Oentrysched \
+Odataprefetch +Onolimit"
  CC_LD_RT="-Wl,+b," ;;
*-hpux11.[01]*)
  CC=cc CFLAGS="-z +O2 +Ofltacc +Olit=all +DAportable \
+Oentrysched +Odataprefetch +Onolimit"
  CC_LD_RT="-Wl,+s,+b," ;;
*-hpux*)
  CC=cc CFLAGS="-z +O2 +Ofltacc +Olit=all +Oentrysched \
+Odataprefetch +Onolimit"
  CC_LD_RT="-Wl,+s,+b," ;;
*-irix*)
  CC=cc CFLAGS="-Wl,-woff,84 -Wl,-woff,85 -woff 1009,1429 \
-use_readonly_const -G0 -rdata_shared -DEBUG:optimize_space=ON \
-O2 -OPT:Olimit=0"
  CC_LD_RT="-Wl,-rpath," ;;
i?86*-linuxe3)
  CFLAGS="-O2 -mcpu=pentiumpro -march=pentiumpro"
  CC_LD_RT="-Wl,-rpath," ;;
i?86*-linux*)
  CFLAGS="-O2 -mtune=pentiumpro -march=pentiumpro"
  CC_LD_RT="-Wl,-rpath," ;;
*-linux*)
  CC_LD_RT="-Wl,-rpath," ;;
*-osf*)
  CC=cc CFLAGS="-O2 -arch ev5 -msym -readonly_strings"
  CC_LD_RT="-Wl,-rpath," ;;
i?86*-solaris*)
  CC=cc CFLAGS="-mr -Qn -xstrconst -xO2 -xtarget=pentium4"
  CC_LD_RT="-R" ;;
*-solaris2.[678])
  CC=cc CFLAGS="-mr -Qn -xstrconst -xO2 -xtarget=ultra2 \
-xarch=v8plusa"
  CC_LD_RT="-R" ;;
*-solaris*)
  CC=cc CFLAGS="-mr -Qn -xstrconst -xO2 -xtarget=ultra2 \
-m32 -xarch=sparcvis"
  CC_LD_RT="-R" ;;
esac
]]>
      </script-header>

      <configure>
<![CDATA[
export PATH=${SB_VAR_FPING}/sbin:$PATH

${SHELL} ./configure CC="${CC-gcc}" CFLAGS="${CFLAGS--O2}" \
CPPFLAGS="-I${SB_VAR_OPENLDAP_INC} \
${CPPFLAGS+${CPPFLAGS}}" \
LDFLAGS="-L${SB_VAR_OPENLDAP_LIB} ${CC_LD_RT}${SB_VAR_OPENLDAP_LIB}:\
${SB_VAR_LIBOPENSSL_LIB}:${SB_VAR_PGSQL_LIB}:${SB_VAR_MYSQL_LIB} \
${LDFLAGS+${LDFLAGS}}" \
--with-nagios-user=nagios --with-nagios-group=nagios \
${SB_VAR_GETTEXT+--with-libintl-prefix=${SB_VAR_GETTEXT}} \
${SB_VAR_LIBICONV+--with-libiconv-prefix=${SB_VAR_LIBICONV}} \
--sysconfdir=${_sysconfdir} --localstatedir=${_localstatedir} \
--with-openssl=${SB_VAR_LIBOPENSSL} --with-pgsql=${SB_VAR_PGSQL} \
--with-mysql=${SB_VAR_MYSQL} --disable-dependency-tracking \
--prefix=${SB_INSTALL_PREFIX}

gmake configure
]]>
      </configure>

      <install>
<![CDATA[
${SB_PATH_INSTALL} -d -m 755 -o nagios -g nagios ${_sysconfdir}
gmake install
${SB_PATH_INSTALL} -m 644 -o nagios -g nagios \
lib/nagios-plugin-paths.cnf ${_sysconfdir}
]]>
      </install>

      <uninstall>
<![CDATA[
rm ${SB_INSTALL_PREFIX}/libexec/*
]]>
      </uninstall>
    </module>

    <notes>
      <note type="installation">
        <para>Nagios requires a special user
"<command>nagios</command>" and two groups "<command>nagios</command>"
and "<command>nagcmd</command>". These can be changed in the
<command>/etc${SB_INSTALL_PREFIX}/nagios.cnf</command> configuration file.</para>
        <para>Log files and other data are stored in the
/var${SB_INSTALL_PREFIX} directory. These may also be changed in the
<command>/etc${SB_INSTALL_PREFIX}/nagios.cnf</command> configuration file.</para>
        <para>Some of the plugins may not function correctly without
other packages being installed.</para>
        <para> In other cases it is possible to modify the paths that
the plugins use to execute other tools and utilities by modifying the
<command>/etc${SB_INSTALL_PREFIX}/nagios-plugin-paths.cnf</command> configuration
file.</para>
      </note>
    </notes>

    <changelog>
      <change date="2012 January 26" revision="3"
      author="Peter O'Gorman" email="pogma@thewrittenword.com">
        <item><para>Update fcpackage dependency from 2.6 to
2.8</para></item>
        <item><para>Update freetype dependency from 2.3.7 to
2.4.6</para></item>
        <item><para>Update gettext dependency from 0.17 to
0.18.1.1</para></item>
        <item><para>Update glib dependency from 2.16.5 to
2.26.1</para></item>
        <item><para>Update jpeg dependency from 6b to 8b</para></item>
        <item><para>Update libiconv dependency from 1.12 to
1.13.1</para></item>
        <item><para>Update libpng dependency from 1.2.18 to
1.4.4</para></item>
        <item><para>Update mysql dependency from 5.0.81 to
5.5.15</para></item>
        <item><para>Update net-snmp dependency from 5.4.2.1 to
5.7.1</para></item>
        <item><para>Update openldap dependency from 2.4.12 to
2.4.26</para></item>
        <item><para>Update openssh dependency from 5.2 to
5.9</para></item>
        <item><para>Update openssl dependency from 0.9.8h to
1.0.0e</para></item>
        <item><para>Update perl dependency from 5.8.8 to
5.12.2</para></item>
        <item><para>Update pkgconfig dependency from 0.23 to
0.25</para></item>
        <item><para>Update postfix dependency from 2.5.6 to
2.8.4</para></item>
        <item><para>Update postgresql dependency from 8.3.7 to
9.0.6</para></item>
        <item><para>Update samba dependency from 3.4.3 to
3.6.1</para></item>
        <item><para>Update zlib dependency from 1.2.3 to
1.2.5</para></item>
      </change>

      <change date="2010 March 17" revision="2"
      author="Albert Chin-A-Young" email="china@thewrittenword.com">
        <item><para>Update fcpackage dependency from 2.4 to
2.6</para></item>
        <item><para>Update freetype dependency from 2.3.5 to
2.3.7</para></item>
        <item><para>Update gettext dependency from 0.14.1 to
0.17</para></item>
        <item><para>Update glib dependency from 2.12.13 to
2.16.5</para></item>
        <item><para>Update libiconv dependency from 1.9.2 to
1.12</para></item>
        <item><para>Update mysql dependency from 5.0.45 to
5.0.81</para></item>
        <item><para>Update net-snmp dependency from 5.4.1 to
5.4.2.1</para></item>
        <item><para>Update openldap dependency from 2.3.37 to
2.4.12</para></item>
        <item><para>Update openssh dependency from 4.7 to
5.2</para></item>
        <item><para>Update openssl dependency from 0.9.8e to
0.9.8h</para></item>
        <item><para>Update perl dependency from 5.8.6 to
5.8.8</para></item>
        <item><para>Update pkgconfig dependency from 0.21 to
0.23</para></item>
        <item><para>Update postfix dependency from 2.4.6 to
2.5.6</para></item>
        <item><para>Update postgresql dependency from 8.2.5 to
8.3.7</para></item>
        <item><para>Update python dependency from 2.5.1 to
2.5.2</para></item>
        <item><para>Update samba dependency from 3.0.28 to
3.4.3</para></item>
      </change>
    </changelog>
  </program>
</programs>

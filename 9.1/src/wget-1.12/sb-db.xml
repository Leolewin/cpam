<?xml version="1.0"?>
<programs>
<!DOCTYPE programs SYSTEM "sb-db.dtd">
  <program name="wget" version="1.12" revision="3">
    <build-name>${SB_PROG_NAME}-${SB_PROG_VER}</build-name>

    <install-name>${SB_PROG_NAME}112</install-name>

    <sources>
      <source checksum="308a5476fc096a8a525d07279a6f6aa3"
        checksum-type="md5" size="1609032"
        path="src/wget-1.12.tar.bz2"/>
      <patch checksum="b68cc576c36969926c97e409ac19b096"
        checksum-type="md5" size="6963"
        path="src/wget-1.12.CVE-2010-2252.patch"/>
      <patch checksum="986cfcf93d4865135a435fb0d34ae541"
        checksum-type="md5" size="14737"
        path="src/wget-1.12.tww.patch"/>
      <patch checksum="3244c592deb871d2d8f341890809807e"
        checksum-type="md5" size="162279"
        path="src/wget-1.12.auto.patch"/>
    </sources>

    <dependencies>
      <depend program="openssl" var="LIBOPENSSL"
        install-name="libopenssl10">v&gt;=1.0.0e</depend>
      <depend program="gettext" var="GETTEXT"
        install-name="gettext018"
        add-path="prepend">v&gt;=0.18.1.1</depend>
      <depend program="libiconv" var="LIBICONV"
        install-name="libiconv113">v&gt;=1.13</depend>
      <depend program="libidn" var="LIBIDN"
        install-name="libidn121">v&gt;=1.21</depend>
      <depend program="perl" add-path="prepend"
        type="build">v==5.12.2</depend>
    </dependencies>

    <script-header>
<![CDATA[
_datadir="${INSTALL_PREFIX}/share"
_docdir="${INSTALL_PREFIX}/doc"
_sysconfdir="${INSTALL_PREFIX}/etc"
]]>
    </script-header>

    <configure>
<![CDATA[
case "${SB_SYSTYPE}" in
*-aix*)
  CC=xlc CFLAGS="-O2 -qro -qroconst -qmaxmem=-1 -qarch=ppc"
  LDFLAGS="-Wl,-brtl -Wl,-blibpath:/usr/lib"
  CC_LD_RT="-Wl,-blibpath:" ;;

ia64*-hpux*)
  CC=cc CFLAGS="-z +O2 +Ofltacc +Olit=all +Oentrysched \
+Odataprefetch +Onolimit"
  CC_LD_RT="-Wl,+b," ;;
*-hpux10*)
  CC=cc CFLAGS="-Ae -z +O2 +Ofltacc +ESlit +DAportable \
+Oentrysched +Odataprefetch +Onolimit"
  CC_LD_RT="-Wl,+s,+b,"

  ARGS="--disable-threads" ;;
*-hpux11.[01]*)
  CC=cc CFLAGS="-z +O2 +Ofltacc +Olit=all +DAportable \
+Oentrysched +Odataprefetch +Onolimit"
  CC_LD_RT="-Wl,+s,+b,"

  ARGS="--disable-threads" ;;
*-hpux*)
  CC=cc CFLAGS="-z +O2 +Ofltacc +Olit=all +Oentrysched \
+Odataprefetch +Onolimit"
  CC_LD_RT="-Wl,+s,+b," ;;
*-irix*)
  CC=cc CFLAGS="-Wl,-woff,84 -Wl,-woff,85 -woff 1429 \
-use_readonly_const -G0 -rdata_shared -DEBUG:optimize_space=ON \
-O2 -OPT:Olimit=0"
  CC_LD_RT="-Wl,-rpath,"

  ARGS="--disable-ipv6" ;;
i?86*-linuxe3)
  CFLAGS="-O2 -mcpu=pentiumpro -march=pentiumpro"
  CC_LD_RT="-Wl,-rpath," ;;
i?86*-linuxe[456]|i?86-suse-linuxe1?)
  CFLAGS="-O2 -mtune=pentiumpro -march=pentiumpro"
  CC_LD_RT="-Wl,-rpath," ;;
*-linux*)
  CC_LD_RT="-Wl,-rpath," ;;
*-osf*)
  CC=cc CFLAGS="-O2 -arch ev5 -msym -readonly_strings"
  CC_LD_RT="-Wl,-rpath," ;;
i?86*-solaris*)
  CC=cc CFLAGS="-mr -Qn -xstrconst -xO2 -xtarget=pentium4"
  CC_LD_RT="-R" ;;
*-solaris2.[678])
  CC=cc CFLAGS="-mr -Qn -xstrconst -xO2 -xtarget=ultra2 \
-xarch=v8plusa"
  CC_LD_RT="-R" ;;
*-solaris*)
  CC=cc CFLAGS="-mr -Qn -xstrconst -xO2 -xtarget=ultra2 \
-m32 -xarch=sparcvis"
  CC_LD_RT="-R" ;;
esac

${SHELL} ./configure CC="${CC:-gcc}" CFLAGS="${CFLAGS:--O2}" \
LDFLAGS="${SB_VAR_LIBOPENSSL+${CC_LD_RT}${SB_VAR_LIBOPENSSL_LIB}} \
${SB_VAR_LIBIDN+${CC_LD_RT}${SB_VAR_LIBIDN_LIB}} \
${LDFLAGS+${LDFLAGS}}" \
${SB_VAR_GETTEXT+--with-libintl-prefix=${SB_VAR_GETTEXT}} \
${SB_VAR_LIBICONV+--with-libiconv-prefix=${SB_VAR_LIBICONV}} \
${SB_VAR_LIBOPENSSL+--with-libssl-prefix=${SB_VAR_LIBOPENSSL}} \
--with-libidn${SB_VAR_LIBIDN+=${SB_VAR_LIBIDN}} \
--disable-dependency-tracking --infodir="${SB_INSTALL_PREFIX}/info" \
--mandir="${SB_INSTALL_PREFIX}/man" --datarootdir=${_datadir} \
--datadir=${_datadir} --sysconfdir=${_sysconfdir} ${ARGS+${ARGS}} \
--prefix=${SB_INSTALL_PREFIX}

# remove info files
(rm -f doc/wget.info*) 2>/dev/null || :

gmake -C doc sample.wgetrc.munged_for_texi_inclusion

# fix path to wgetrc
${SB_PATH_SED} -i -e "\
s!/usr/local/etc/wgetrc!${_sysconfdir//@/@@}/wgetrc!" \
doc/sample.wgetrc.munged_for_texi_inclusion \
doc/wget.texi
]]>
    </configure>

    <install>
<![CDATA[
gmake install

${SB_PATH_INSTALL} -m 755 -o root -g 0 -d ${_docdir}/texinfo
${SB_PATH_INSTALL} -m 644 -o root -g 0 doc/fdl.texi doc/wget.texi \
doc/sample.wgetrc.munged_for_texi_inclusion doc/version.texi \
${_docdir}/texinfo
]]>
    </install>

    <notes>
      <change from="1.11.4" to="1.12">
        <item><para>SECURITY FIX: It had been possible to trick Wget
into accepting SSL certificates that don't match the host name,
through the trick of embedding NUL characters into the certs' common
name.</para></item>
        <item><para>Added support for CSS. This includes:</para>
        <unorderedlist>
          <item><para>Parsing links from CSS files, and from CSS
content found in HTML style tags and attributes.</para></item>
          <item><para>Supporting conversion of links found within CSS
content, when --convert-links is specified.</para></item>
          <item><para>Ensuring that CSS files end in the ".css"
filename extension, when --convert-links is specified.</para></item>
        </unorderedlist></item>
        <item><para>Added support for Internationalized Resource
Identifiers (IRIs, RFC 3987). When support is enabled (requires libidn
and libiconv), links with non-ASCII bytes are translated from their
source encoding to UTF-8 before percent-encoding.</para></item>
        <item><para>Wget now provides more sensible exit status codes
when downloads don't proceed as expected (see the
manual).</para></item>
        <item><para>--default-page option (and associated wgetrc
command) added to support alternative default names for
index.html.</para></item>
        <item><para>--ask-password option (and associated wgetrc
command) added to support password prompts at the
console.</para></item>
        <item><para>The --input-file option now also handles
retrieving links from an external file.</para></item>
        <item><para>The output generated by the --version option now
includes information on how it was built, and the set of
configure-time options that were selected.</para></item>
        <item><para>--html-extension has been renamed to
--adjust-extension, to reflect the fact that it now also applies to
CSS content. --html-extension is still acceptable, but is now
deprecated.</para></item>
        <item><para>An "ascii" specifier is now accepted by
--restrict-file-names, which forces the percent-encoding of all
non-ASCII bytes</para></item>
        <item><para>Several previously existing, but undocumented
.wgetrc options are now documented: save_headers, spider, and
user_agent, auth_no_challenge, and keep_session_cookies. Also added
documentation for the "lowercase" and "uppercase" values for
--restrict-file-names, which had been present since Wget
1.11.</para></item>
      </change>

      <change from="1.11.3" to="1.11.4">
        <item><para>Fixed an issue (apparently a regression) where -O
would refuse to download when -nc was given, even though the file
didn't exist.</para></item>
        <item><para>Fixed a situation where Wget could abort with
--continue if the remote server gives a content-length of zero when
the file exists locally with content.</para></item>
        <item><para>Fixed a crash on some systems, due to Wget casting
a pointer-to-long to a pointer-to-time_t</para></item>
        <item><para>Translation updates for Catalan</para></item>
      </change>

      <change from="1.11.2" to="1.11.3">
        <item><para>Downgraded -N with -O to a warning, rather than an
error</para></item>
        <item><para>Translation updates</para></item>
      </change>

      <change from="1.11.1" to="1.11.2">
        <item><para>Fixed a problem in authenticating over HTTPS
through a proxy. (Regression in 1.11 over 1.10.2.)</para></item>
        <item><para>The combination of -r or -p with -O, which was
disallowed in 1.11, has been downgraded to a warning in 1.11.2. (-O
and -N, which was never meaningful, is still an error.)</para></item>
        <item><para>Further improvements to progress bar displays in
non-English locales (too many spaces could be inserted, causing the
display to scroll).</para></item>
        <item><para>Successive invocations of Wget on FTP URLS, with
--no-remove-listing and --continue, was causing Wget to append, rather
than replace, information in the .listing file, and thereby download
the same files multiple times. This has been fixed in
1.11.2.</para></item>
        <item><para>Wget 1.11 no longer allowed ".." to persist at the
beginning of URLs, for improved conformance with RFC 3986. However,
this behavior presents problems for some FTP setups, and so they are
now preserved again, for FTP URLs only.</para></item>
      </change>

      <change from="1.11" to="1.11.1">
        <item><para>Interrupted downloads no longer result in renaming
the file (regression in 1.11 over 1.10.2).</para></item>
        <item><para>Progress bar now displays correctly in non-English
locales (and a related assertion failure was fixed).</para></item>
        <item><para>Wget no longer issues a GET request over HTTP for
files it should know it's not going to download (regression in 1.11
over 1.10.2).</para></item>
        <item><para>Added option --auth-no-challenge, to support
broken pre-1.11 authentication-before-server-challenge, which turns
out to still be useful for some limited cases.</para></item>
        <item><para>Documentation of accept/reject lists in the
manual's "Types of Files" section now explains various aspects of
their behavior that may be surprising, and notes that they may change
in the future.</para></item>
        <item><para>Documentation of --no-parents now explains how a
trailing slash, or lack thereof, in the specified URL, will affect
behavior.</para></item>
      </change>

      <change from="1.10.2" to="1.11">
        <item><para>Timestamping now uses the value from the most
recent HTTP response, rather than the first one it got.</para></item>
        <item><para>Authentication information is no longer sent as
part of the Referer header in recursive fetches.</para></item>
        <item><para>No authentication credentials are sent until a
challenge is issued, for improved security. Authentication handling is
still not RFC-compliant, as once a Basic challenge has been received,
it will assume it can send credentials to any URL at that same host,
and not just the ones at or below the original authenticated location.
Credentials for Digest authentication are still never saved or issued
automatically, and continue to require a challenge for each
resource.</para></item>
        <item><para>Added --max-redirect option, allowing the user to
specify what should be the maximum number of HTTP redirects to
follow.</para></item>
        <item><para>Wget now supports saving HTTP downloads using file
names specified by the `Content-Disposition' header.  This is a
standard way of specifying the file name used by many web dynamically
generated pages. However, the current implementation is inefficient,
and known to have bugs. It is EXPERIMENTAL only, and not enabled by
default. Use --content-disposition to enable it.</para></item>
        <item><para>The new option `--ignore-case' makes Wget ignore
case when matching files, directories, and wildcards.  This affects
the -X, -I, -A, and -R options, as well as globbing in FTP
URLs.</para></item>
        <item><para>ETA projection is now displayed in "dot" progress
output as well as in the default progress bar.  (The dot progress is
used by default when logging Wget's output to file using the `-o'
option.)</para></item>
        <item><para>The "lockable boolean" argument type is no longer
supported.  It was only used by the passive_ftp .wgetrc setting.  If
you're running broken scripts or Perl modules that unconditionally
specify `--passive-ftp' and your firewall disallows it, you can
override them by replacing wget with a script that execs wget "$@"
--no-passive-ftp.</para></item>
        <item><para>The source code has been migrated to Mercurial.
The repositories are available at http://hg.addictivecode.org/. Prior
to this, the source code was hosted on Subversion (migrated from the
original CVS); you can still get access to older tags and branches
for Wget in the Subversion repository at
http://addictivecode.org/svn/wget/.</para></item>
      </change>

      <change from="1.10.1" to="1.10.2">
        <item><para>SSL improvements</para></item>
        <item><para>Fix for NTLM Buffer Overflow
Vulnerability</para></item>
      </change>

      <change from="1.9" to="1.10">
        <items name="SSL/TLS changes">
          <item><para>SSL/TLS downloads now attempt to verify the
server's certificate against the recognized certificate authorities.
This requires CA certificates to have been installed in a location
visible to the OpenSSL library. If this is not the case, you can get
the bundle yourself from a source you trust (for example, the bundle
extracted from Mozilla available at
http://curl.haxx.se/docs/caextract.html), and point Wget to the PEM
file using the "--ca-certificate" command-line option or the
corresponding ".wgetrc" command.</para></item>
          <item><para>Secure downloads now verify that the host name
in the URL matches the "common name" in the certificate presented by
the server.</para></item>
          <item><para>Although the above checks provide more secure
downloads, they unavoidably break interoperability with some sites
that worked with previous versions, particularly those using
self-signed, expired, or otherwise invalid certificates. If you
encounter "certificate verification" errors or complaints that "common
name doesn't match requested host name" and are convinced of the
site's authenticity, you can use "--no-check-certificate" to bypass
both checks.</para></item>
          <item><para>Talking to SSL/TLS servers over proxies now
actually works. Previous versions of Wget erroneously sent GET
requests for https URLs. Wget 1.10 utilizes the CONNECT method
designed for this purpose.</para></item>
          <item><para>The SSL/TLS-related options have been redesigned
and, for the first time, documented in the manual. The old,
undocumented, options are no longer supported.</para></item>
        </items>

        <item><para>Downloading files larger than 2GB, sometimes
referred to as "large files", now works on systems that support them.
This includes the majority of modern Unixes, as well as MS
Windows.</para></item>
        <item><para>IPv6 is now supported by Wget. Unlike the
experimental code in 1.9, this version supports dual-family systems.
The new flags "--inet4" and "--inet6" (or "-4" and "-6" for short)
force the use of IPv4 and IPv6 respectively. Note that IPv6 support
has not yet been tested on Windows.</para></item>
        <item><para>Microsoft's proprietary "NTLM" method of HTTP
authentication is now supported. This authentication method is
undocumented and only used by IIS. Note that *proxy* authentication
is not supported in this release; you can only authenticate to the
target web site.</para></item>
        <item><para>Wget no longer truncates partially downloaded
files when download has to start over because the server doesn't
support Range. Instead, with such servers Wget now simply ignores the
data up to the byte where the last attempt left off, and only then
continues appending to the file. That way the downloaded file never
shrinks, and download retries from servers without support for partial
downloads work even when downloading to stdout.</para></item>
        <item><para>Passive FTP is now the default FTP transfer mode.
Use "--no-passive-ftp" or specify "passive_ftp = off" in your init
file to revert to the old behavior.</para></item>
        <item><para>The "--header" option can now be used to override
generated headers. For example, 'wget --header="Host: foo.bar"
http://127.0.0.1' tells Wget to connect to localhost, but to specify
"foo.bar" in the "Host" header. In previous versions such use of
"--header" lead to duplicate headers in HTTP requests.</para></item>
        <item><para>The responses without headers, aka "HTTP 0.9"
responses, are detected and handled. Although HTTP 0.9 has long been
obsolete, it is still occasionally used, sometimes by
accident.</para></item>
        <item><para>The progress bar is now updated regularly even
when the data does not arrive from the network.</para></item>
        <item><para>Wget no longer preserves permissions of files
retrieved by FTP by default. Anonymous FTP servers frequently use
permissions like "664", which might not be what the user wants. The
new option "--preserve-permissions" and the corresponding ".wgetrc"
variable can be used to revert to the old behavior.</para></item>
        <item><para>The new option "--protocol-directories" instructs
Wget to also use the protocol name as a directory component of local
file names.</para></item>
        <item><para>Options that previously unconditionally set or
unset various flags are now boolean options that can be invoked as
either "--OPTION" or "--no-OPTION". Options that required an argument
"on" or "off" have also been changed this way, but they still accept
the old syntax for backward compatibility. For example, instead of
"--glob=off" you can write "--no-glob".</para>
        <para>Allowing "--no-OPTION" for every "--OPTION" and the
other way around is useful because it allows the user to override
non-default behavior specified via ".wgetrc".</para></item>
        <item><para>The new option "--keep-session-cookies" causes
"--save-cookies" to save session cookies (normally only kept in
memory) along with the permanent ones. This is useful because many
sites track important information, such as whether the user has
authenticated, in session cookies. With this option multiple Wget
runs are treated as a single browser session.</para></item>
        <item><para>Wget now supports the --ftp-user and
--ftp-password command switches to set username and password for FTP,
and the --user and --password command switches to set username and
password for both FTP and HTTP. The --http-passwd and --proxy-passwd
command switches have been renamed to --http-password and
--proxy-password respectively, and the related http_passwd and
proxy_passwd .wgetrc commands to http_password and proxy_password
respectively. The login and passwd .wgetrc commands have been
deprecated.</para></item>
        <item><para>wget -b' now works correctly under
Windows</para></item>
      </change>
    </notes>

    <changelog>
      <change date="2012 January 17" revision="3"
      author="Peter O'Gorman" email="pogma@thewrittenword.com">
        <item><para>Update openssl dependency from 0.9.8h to
1.0.0e</para></item>
        <item><para>Update gettext dependency from 0.17 to
0.18.1.1</para></item>
        <item><para>Update libiconv dependency from 1.12 to
1.13.1</para></item>
        <item><para>Update libidn dependency from 1.11 to
1.21</para></item>
        <item><para>Update perl dependency from 5.8.8 to
5.12.2</para></item>
      </change>

      <change date="2010 October 29" revision="2"
      author="Peter O'Gorman" email="pogma@thewrittenword.com">
        <item><para>Add support for RHEL 6</para></item>
      </change>
    </changelog>
  </program>
</programs>

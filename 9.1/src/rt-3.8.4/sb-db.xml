<?xml version="1.0"?>
<programs>
<!DOCTYPE programs SYSTEM "sb-db.dtd">
  <program name="rt" version="3.8.4" revision="2"
  systype="*-aix*|*-hpux11*|*-irix*|*-linux*|*-solaris*">
    <build-name>${SB_PROG_NAME}-${SB_PROG_VER}</build-name>

    <install-name>${SB_PROG_NAME}38</install-name>

    <sources>
      <source checksum="cdfdbd954203a8bc2c663a6847218ccc"
        checksum-type="md5" size="3320207"
        path="src/rt-3.8.4.tar.gz"/>
      <patch checksum="7ca05a3ac05d14e911659052d4138bb4"
        checksum-type="md5" size="2716"
        path="src/rt-3.8.4.tww.patch"/>
    </sources>

    <dependencies replace="0">
      <depend program="Apache-Session"
        module="5.12.2">v&gt;=1.89</depend>
      <depend program="CGI.pm" module="5.12.2">v&gt;=3.55</depend>
      <depend program="CSS-Squish"
        module="5.12.2">v&gt;=0.10</depend>
      <depend program="Cache-Cache"
        module="5.12.2">v&gt;=1.06</depend>
      <depend program="Cache-Simple-TimedExpiry"
        module="5.12.2">v&gt;=0.27</depend>
      <depend program="Calendar-Simple"
        module="5.12.2">v&gt;=1.20</depend>
      <depend program="Class-Accessor-Chained"
        module="5.12.2">v&gt;=0.01</depend>
      <depend program="Class-Container"
        module="5.12.2">v&gt;=0.12</depend>
      <depend program="Class-Load"
        module="5.12.2">v&gt;=0.17</depend>
      <depend program="Class-ReturnValue"
        module="5.12.2">v&gt;=0.55</depend>
      <depend program="DBI" module="5.12.2">v&gt;=1.616</depend>
      <depend program="DBIx-SearchBuilder"
        module="5.12.2">v&gt;=1.61</depend>
      <depend program="Data-ICal" module="5.12.2">v&gt;=0.18</depend>
      <depend program="Devel-StackTrace"
        module="5.12.2">v&gt;=1.27</depend>
      <depend program="Email-Address"
        module="5.12.2">v&gt;=1.889</depend>
      <depend program="Encode" module="5.12.2">v&gt;=2.44</depend>
      <depend program="Exception-Class"
        module="5.12.2">v&gt;=1.32</depend>
      <depend program="File-ShareDir"
        module="5.12.2">v&gt;=1.00</depend>
      <depend program="File-Temp"
        module="5.12.2">v&gt;=0.22 </depend>
      <depend program="HTML-Mason"
        module="5.12.2">v&gt;=1.45</depend>
      <depend program="HTML-Parser"
        module="5.12.2">v&gt;=3.68</depend>
      <depend program="HTML-RewriteAttributes"
        module="5.12.2">v&gt;=0.04</depend>
      <depend program="HTTP-Server-Simple"
        module="5.12.2">v&gt;=0.44</depend>
      <depend program="HTTP-Server-Simple-Mason"
        module="5.12.2">v&gt;=0.14</depend>
      <depend program="Hook-LexWrap"
        module="5.12.2">v&gt;=0.22</depend>
      <depend program="Locale-Maketext-Fuzzy"
        module="5.12.2">v&gt;=0.10</depend>
      <depend program="Locale-Maketext-Lexicon"
        module="5.12.2">v&gt;=0.91</depend>
      <depend program="Log-Dispatch"
        module="5.12.2">v&gt;=2.22</depend>
      <depend program="MIME-tools"
        module="5.12.2">v&gt;=5.427</depend>
      <depend program="Module-Versions-Report"
        module="5.12.2">v&gt;=1.06</depend>
      <depend program="Net-Server"
        module="5.12.2">v&gt;=0.97</depend>
      <depend program="Params-Validate"
        module="5.12.2">v&gt;=0.91</depend>
      <depend program="Regexp-Common"
        module="5.12.2">v&gt;=2.122</depend>
      <depend program="Sys-Syslog"
        module="5.12.2">v&gt;=0.29</depend>
      <depend program="Test-LongString"
        module="5.12.2">v&gt;=0.15</depend>
      <depend program="Tree-Simple"
        module="5.12.2">v&gt;=1.18</depend>
      <depend program="Text-Quoted"
        module="5.12.2">v&gt;=2.05</depend>
      <depend program="Text-Template"
        module="5.12.2">v&gt;=1.45</depend>
      <depend program="Text-WikiFormat"
        module="5.12.2">v&gt;=0.79</depend>
      <depend program="Text-Wrapper"
        module="5.12.2">v&gt;=1.02</depend>
      <depend program="Text-vFile-asData"
        module="5.12.2">v&gt;=0.07</depend>
      <depend program="UNIVERSAL-require"
        module="5.12.2">v&gt;=0.13</depend>
      <depend program="Want" module="5.12.2">v&gt;=0.18</depend>
      <depend program="gd" var="LIBGD" install-name="libgd20"
        module="GD-5.12.2">v&gt;=2.0.35</depend>
      <depend program="gd" install-name="libgd20"
        module="GDTextUtil-5.12.2">v&gt;=2.0.35</depend>
      <depend program="gd" install-name="libgd20"
        module="GDGraph-5.12.2">v&gt;=2.0.35</depend>
      <depend program="mod_perl" var="MOD_PERL"
        module="Apache-DBI-5.12.2"
        systype="!*-osf*">v&gt;=2.0.4</depend>
      <depend program="mysql" var="MYSQL" module="DBD-mysql-5.12.2"
        add-path="prepend">v==5.5.15</depend>
      <depend program="postgresql" var="PGSQL" module="DBD-Pg-5.12.2"
        add-path="prepend">v==9.0.6</depend>
      <depend program="db" var="LIBDB"
        module="DB_File-5.12.2">v==4.7.25</depend>
      <depend program="gd" install-name="libgd20"
        add-path="prepend">v&gt;=2.0.35</depend>
      <depend program="perl" var="PERL"
        add-path="prepend">v==5.12.2</depend>
    </dependencies>

    <script-header>
<![CDATA[
_datadir="${SB_INSTALL_PREFIX}/share"
_docdir="${SB_INSTALL_PREFIX}/doc"
_localstatedir="/var${SB_INSTALL_PREFIX}"
_sysconfdir="/etc${SB_INSTALL_PREFIX}"

export PERL5LIB="${SB_VAR_LIBDB_LIB}/perl5122:\
${SB_VAR_LIBGD_LIB}/perl5122:\
${SB_VAR_MOD_PERL_LIB}/perl5122:\
${SB_VAR_MYSQL_LIB}/perl5122:\
${SB_VAR_PGSQL_LIB}/perl5122"
]]>
    </script-header>

    <configure>
<![CDATA[
cat << _EOF >> config.layout
<Layout CD>
  bindir:               ${SB_INSTALL_PREFIX}/bin
  sbindir:              ${SB_INSTALL_PREFIX}/sbin
  sysconfdir:           ${_sysconfdir}
  libdir:               ${SB_INSTALL_PREFIX_LIB}
  manualdir:            ${_docdir}
  localstatedir:        ${_localstatedir}
  htmldir:              ${_datadir}
  logfiledir:           ${_localstatedir}/log
  masonstatedir:        ${_localstatedir}/cache/mason_data
  sessionstatedir:      ${_localstatedir}/cache/session_data
  customdir:            ${SB_INSTALL_PREFIX}/custom
  custometcdir:         ${_sysconfdir}/custom
  customhtmldir:        \${customdir}/html
  customlexdir:         \${customdir}/po
  customlibdir:         \${customdir}/lib
</Layout>
_EOF

${SHELL} ./configure --with-web-handler=standalone,modperl2 \
--disable-graphviz --enable-gd --disable-gpg --enable-layout=CD \
--prefix=${SB_INSTALL_PREFIX}
]]>
    </configure>

    <build>
<![CDATA[
:
]]>
    </build>

    <install>
<![CDATA[
gmake install

rm ${SB_INSTALL_PREFIX}/sbin/rt-test-dependencies
set -x
(cd ${SB_INSTALL_PREFIX}
${SB_PATH_SED} -i -e "\
/use RT;/ { i \\
use lib \"${SB_INSTALL_PREFIX}/lib\";
i \\
use lib \"${SB_INSTALL_PREFIX}/custom/lib\";
}" sbin/rt-server sbin/rt-email-group-admin sbin/rt-setup-database \
sbin/rt-email-digest sbin/rt-email-dashboards \
sbin/rt-dump-database bin/rt-crontool bin/webmux.pl bin/standalone_httpd 

${SB_PATH_SED} -i -e "\
/use RT::Shredder / { i \\
use lib \"${SB_INSTALL_PREFIX}/lib\";
i \\
use lib \"${SB_INSTALL_PREFIX}/custom/lib\";
}" sbin/rt-shredder
)
]]>
    </install>

    <uninstall>
<![CDATA[
rm -rf ${SB_INSTALL_PREFIX} ${_localstatedir} ${_sysconfdir}
]]>
    </uninstall>

    <licenses>
      <license path="gpl-2.license"/>
    </licenses>

    <notes>
      <note type="installation">
        <para>Unless configured to use the "standalone" web
server, this package requires a http server with
mod_perl-2.x</para>
        <para>The files in /var${SB_INSTALL_PREFIX}  must be writable by
the webserver, similarly the file in /etc${SB_INSTALL_PREFIX}  must be
readable</para>
      </note>

      <note type="configuration">
        <para>The RT_Config.pm and RT_SiteConfig.pm
configuration files are in /etc${SB_INSTALL_PREFIX}</para>
        <para>After editing the configuration files,
<command>rt-setup-database</command> can be used to install the
database and schemas etc.</para>
        <para>To use apache with mod_perl, you could, for
example, add the following to httpd.conf</para>
        <screen>
Alias /rt "${SB_INSTALL_PREFIX}/share"

PerlRequire ${SB_INSTALL_PREFIX}/bin/webmux.pl

&lt;Directory "${SB_INSTALL_PREFIX}/share"&gt;
  AllowOverride All
  Options ExecCGI FollowSymLinks

  RewriteEngine On
  RedirectMatch permanent (.*)/$ $1/index.html
  AddDefaultCharset UTF-8
  SetHandler perl-script
  PerlHandler RT::Mason
&lt;/Directory&gt;
        </screen>

        <para>Cronjobs, and mail also need to be set up, see
<ulink url="http://wiki.bestpractical.com/view/HomePage">http://wiki.bestpractical.com/view/HomePage</ulink>
for more information.</para>
      </note>
    </notes>

    <changelog>
      <change date="2012 January 23" revision="2"
      author="Peter O'Gorman" email="pogma@thewrittenword.com">
        <item><para>Update Apache-Session dependency from 1.88 to
1.89</para></item>
        <item><para>Update CGI.pm dependency from 3.43 to
3.55</para></item>
        <item><para>Update CSS-Squish dependency from 0.08 to
0.10</para></item>
        <item><para>Update DBI dependency from 1.607 to
1.616</para></item>
        <item><para>Update DBIx-SearchBuilder dependency from 1.56 to
1.61</para></item>
        <item><para>Update Devel-StackTrace dependency from 1.22 to
1.27</para></item>
        <item><para>Update Encode dependency from 2.33 to
2.44</para></item>
        <item><para>Update Exception-Class dependency from 1.29 to
1.32</para></item>
        <item><para>Update File-Temp dependency from 0.21 to
0.22</para></item>
        <item><para>Update HTML-Mason dependency from 1.42 to
1.45</para></item>
        <item><para>Update HTML-Parser dependency from 3.60 to
3.68</para></item>
        <item><para>Update HTML-RewriteAttributes dependency from 0.03
to 0.04</para></item>
        <item><para>Update HTTP-Server-Simple dependency from 0.38 to
0.44</para></item>
        <item><para>Update HTTP-Server-Simple-Mason dependency from
0.12 to 0.14</para></item>
        <item><para>Update Hook-LexWrap dependency from 0.22 to
0.24</para></item>
        <item><para>Update Locale-Maketext-Lexicon dependency from
0.77 to 0.91</para></item>
        <item><para>Update MIME-tools dependency from 5.427 to
5.502</para></item>
        <item><para>Update Net-Server dependency from 0.97 to
0.99</para></item>
        <item><para>Update Params-Validate dependency from 0.91 to
1.00</para></item>
        <item><para>Update Regexp-Common dependency from 2.122 to
2011041701</para></item>
        <item><para>Update Sys-Syslog dependency from 0.27 to
0.29</para></item>
        <item><para>Update Test-LongString dependency from 0.11 to
0.15</para></item>
        <item><para>Update Text-Quoted dependency from 2.05 to
2.06</para></item>
        <item><para>Update Text-vFile-asData dependency from 0.05 to
0.07</para></item>
        <item><para>Update postgresql dependency from 8.3.7 to
9.0.6</para></item>
        <item><para>Update mysql dependency from 5.0.81 to
5.5.15</para></item>
        <item><para>Update perl dependency from 5.8.8 to
5.12.2</para></item>
      </change>
    </changelog>
  </program>
</programs>
